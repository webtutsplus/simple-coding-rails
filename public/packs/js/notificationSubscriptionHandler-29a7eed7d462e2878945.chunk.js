(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["notificationSubscriptionHandler"],{

/***/ "./app/javascript/packs/notificationSubscriptionHandler.js":
/*!*****************************************************************!*\
  !*** ./app/javascript/packs/notificationSubscriptionHandler.js ***!
  \*****************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("function loadFunctionality() {\n  if (!document.getElementById('notification-subscriptions-area')) {\n    return;\n  }\n\n  var notifiableId = document.getElementById('notification-subscriptions-area').dataset.notifiableId;\n  var notifiableType = document.getElementById('notification-subscriptions-area').dataset.notifiableType;\n  var userStatus = document.body.getAttribute('data-user-status');\n\n  if (userStatus === 'logged-in') {\n    fetch(\"/notification_subscriptions/\".concat(notifiableType, \"/\").concat(notifiableId), {\n      headers: {\n        Accept: 'application/json',\n        'X-CSRF-Token': window.csrfToken,\n        'Content-Type': 'application/json'\n      },\n      credentials: 'same-origin'\n    }).then(function (response) {\n      return response.json();\n    }).then(function (result) {\n      document.getElementById(\"notification-subscription-label_\".concat(result.config)).classList.add('selected'); // checkbox.checked = result;\n    });\n  }\n\n  var updateStatus = function updateStatus() {};\n\n  if (userStatus === 'logged-out') {\n    updateStatus = function updateStatus() {\n      // Disabled because showModal() is globally defined in asset pipeline\n      // eslint-disable-next-line no-undef\n      showModal('notification-subscription');\n    };\n  } else {\n    updateStatus = function updateStatus(target) {\n      var payload = '';\n      var shouldUnsubscribeToNotifications = target.classList.contains('selected') || target.classList.contains('selected-emoji');\n      var allButtons = document.getElementsByClassName('notification-subscription-label');\n\n      for (var i = 0; i < allButtons.length; i += 1) {\n        allButtons[i].classList.remove('selected');\n      }\n\n      if (shouldUnsubscribeToNotifications) {\n        var unsubscribeButton = allButtons.namedItem('unsubscribe');\n        unsubscribeButton.classList.add('selected');\n        payload = unsubscribeButton.dataset.payload;\n      } else {\n        target.classList.add('selected');\n        payload = target.dataset.payload;\n      }\n\n      fetch(\"/notification_subscriptions/\".concat(notifiableType, \"/\").concat(notifiableId), {\n        method: 'POST',\n        headers: {\n          Accept: 'application/json',\n          'X-CSRF-Token': window.csrfToken,\n          'Content-Type': 'application/json'\n        },\n        credentials: 'same-origin',\n        body: JSON.stringify({\n          config: payload // notifiable params are passed via URL\n\n        })\n      });\n    };\n  }\n\n  var subscriptionButtons = document.getElementsByClassName('notification-subscription-label');\n\n  for (var i = 0; i < subscriptionButtons.length; i += 1) {\n    subscriptionButtons[i].addEventListener('click', function (e) {\n      e.preventDefault();\n      updateStatus(e.target);\n\n      if (typeof window.sendHapticMessage !== 'undefined') {\n        window.sendHapticMessage('medium');\n      }\n    });\n    subscriptionButtons[i].addEventListener('keydown', function (e) {\n      if (e.key === 'Enter') {\n        updateStatus(e.target);\n      }\n    });\n  }\n}\n\nwindow.InstantClick.on('change', function () {\n  loadFunctionality();\n});\nloadFunctionality();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hcHAvamF2YXNjcmlwdC9wYWNrcy9ub3RpZmljYXRpb25TdWJzY3JpcHRpb25IYW5kbGVyLmpzP2YwMjUiXSwibmFtZXMiOlsibG9hZEZ1bmN0aW9uYWxpdHkiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwibm90aWZpYWJsZUlkIiwiZGF0YXNldCIsIm5vdGlmaWFibGVUeXBlIiwidXNlclN0YXR1cyIsImJvZHkiLCJnZXRBdHRyaWJ1dGUiLCJmZXRjaCIsImhlYWRlcnMiLCJBY2NlcHQiLCJ3aW5kb3ciLCJjc3JmVG9rZW4iLCJjcmVkZW50aWFscyIsInRoZW4iLCJyZXNwb25zZSIsImpzb24iLCJyZXN1bHQiLCJjb25maWciLCJjbGFzc0xpc3QiLCJhZGQiLCJ1cGRhdGVTdGF0dXMiLCJzaG93TW9kYWwiLCJ0YXJnZXQiLCJwYXlsb2FkIiwic2hvdWxkVW5zdWJzY3JpYmVUb05vdGlmaWNhdGlvbnMiLCJjb250YWlucyIsImFsbEJ1dHRvbnMiLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwiaSIsImxlbmd0aCIsInJlbW92ZSIsInVuc3Vic2NyaWJlQnV0dG9uIiwibmFtZWRJdGVtIiwibWV0aG9kIiwiSlNPTiIsInN0cmluZ2lmeSIsInN1YnNjcmlwdGlvbkJ1dHRvbnMiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInByZXZlbnREZWZhdWx0Iiwic2VuZEhhcHRpY01lc3NhZ2UiLCJrZXkiLCJJbnN0YW50Q2xpY2siLCJvbiJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBU0EsaUJBQVQsR0FBNkI7QUFDM0IsTUFBSSxDQUFDQyxRQUFRLENBQUNDLGNBQVQsQ0FBd0IsaUNBQXhCLENBQUwsRUFBaUU7QUFDL0Q7QUFDRDs7QUFIMEIsTUFJbkJDLFlBSm1CLEdBSUZGLFFBQVEsQ0FBQ0MsY0FBVCxDQUN2QixpQ0FEdUIsRUFFdkJFLE9BTnlCLENBSW5CRCxZQUptQjtBQUFBLE1BT25CRSxjQVBtQixHQU9BSixRQUFRLENBQUNDLGNB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Z0JBLENBQUMsR0FBR1EsbUJBQW1CLENBQUNQLE1BQXhDLEVBQWdERCxDQUFDLElBQUksQ0FBckQsRUFBd0Q7QUFDdERRLHVCQUFtQixDQUFDUixDQUFELENBQW5CLENBQXVCUyxnQkFBdkIsQ0FBd0MsT0FBeEMsRUFBaUQsVUFBQ0MsQ0FBRCxFQUFPO0FBQ3REQSxPQUFDLENBQUNDLGNBQUY7QUFDQW5CLGtCQUFZLENBQUNrQixDQUFDLENBQUNoQixNQUFILENBQVo7O0FBQ0EsVUFBSSxPQUFPWixNQUFNLENBQUM4QixpQkFBZCxLQUFvQyxXQUF4QyxFQUFxRDtBQUNuRDlCLGNBQU0sQ0FBQzhCLGlCQUFQLENBQXlCLFFBQXpCO0FBQ0Q7QUFDRixLQU5EO0FBT0FKLHVCQUFtQixDQUFDUixDQUFELENBQW5CLENBQXVCUyxnQkFBdkIsQ0FBd0MsU0FBeEMsRUFBbUQsVUFBQ0MsQ0FBRCxFQUFPO0FBQ3hELFVBQUlBLENBQUMsQ0FBQ0csR0FBRixLQUFVLE9BQWQsRUFBdUI7QUFDckJyQixvQkFBWSxDQUFDa0IsQ0FBQyxDQUFDaEIsTUFBSCxDQUFaO0FBQ0Q7QUFDRixLQUpEO0FBS0Q7QUFDRjs7QUFFRFosTUFBTSxDQUFDZ0MsWUFBUCxDQUFvQkMsRUFBcEIsQ0FBdUIsUUFBdkIsRUFBaUMsWUFBTTtBQUNyQzdDLG1CQUFpQjtBQUNsQixDQUZEO0FBSUFBLGlCQUFpQiIsImZpbGUiOiIuL2FwcC9qYXZhc2NyaXB0L3BhY2tzL25vdGlmaWNhdGlvblN1YnNjcmlwdGlvbkhhbmRsZXIuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBsb2FkRnVuY3Rpb25hbGl0eSgpIHtcbiAgaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm90aWZpY2F0aW9uLXN1YnNjcmlwdGlvbnMtYXJlYScpKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IHsgbm90aWZpYWJsZUlkIH0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcbiAgICAnbm90aWZpY2F0aW9uLXN1YnNjcmlwdGlvbnMtYXJlYScsXG4gICkuZGF0YXNldDtcbiAgY29uc3QgeyBub3RpZmlhYmxlVHlwZSB9ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXG4gICAgJ25vdGlmaWNhdGlvbi1zdWJzY3JpcHRpb25zLWFyZWEnLFxuICApLmRhdGFzZXQ7XG5cbiAgY29uc3QgdXNlclN0YXR1cyA9IGRvY3VtZW50LmJvZHkuZ2V0QXR0cmlidXRlKCdkYXRhLXVzZXItc3RhdHVzJyk7XG5cbiAgaWYgKHVzZXJTdGF0dXMgPT09ICdsb2dnZWQtaW4nKSB7XG4gICAgZmV0Y2goYC9ub3RpZmljYXRpb25fc3Vic2NyaXB0aW9ucy8ke25vdGlmaWFibGVUeXBlfS8ke25vdGlmaWFibGVJZH1gLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIEFjY2VwdDogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAnWC1DU1JGLVRva2VuJzogd2luZG93LmNzcmZUb2tlbixcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgIH0sXG4gICAgICBjcmVkZW50aWFsczogJ3NhbWUtb3JpZ2luJyxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiByZXNwb25zZS5qc29uKCkpXG4gICAgICAudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICAgIGRvY3VtZW50XG4gICAgICAgICAgLmdldEVsZW1lbnRCeUlkKGBub3RpZmljYXRpb24tc3Vic2NyaXB0aW9uLWxhYmVsXyR7cmVzdWx0LmNvbmZpZ31gKVxuICAgICAgICAgIC5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpO1xuICAgICAgICAvLyBjaGVja2JveC5jaGVja2VkID0gcmVzdWx0O1xuICAgICAgfSk7XG4gIH1cblxuICBsZXQgdXBkYXRlU3RhdHVzID0gKCkgPT4ge307XG5cbiAgaWYgKHVzZXJTdGF0dXMgPT09ICdsb2dnZWQtb3V0Jykge1xuICAgIHVwZGF0ZVN0YXR1cyA9ICgpID0+IHtcbiAgICAgIC8vIERpc2FibGVkIGJlY2F1c2Ugc2hvd01vZGFsKCkgaXMgZ2xvYmFsbHkgZGVmaW5lZCBpbiBhc3NldCBwaXBlbGluZVxuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmXG4gICAgICBzaG93TW9kYWwoJ25vdGlmaWNhdGlvbi1zdWJzY3JpcHRpb24nKTtcbiAgICB9O1xuICB9IGVsc2Uge1xuICAgIHVwZGF0ZVN0YXR1cyA9ICh0YXJnZXQpID0+IHtcbiAgICAgIGxldCBwYXlsb2FkID0gJyc7XG4gICAgICBjb25zdCBzaG91bGRVbnN1YnNjcmliZVRvTm90aWZpY2F0aW9ucyA9XG4gICAgICAgIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykgfHxcbiAgICAgICAgdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQtZW1vamknKTtcbiAgICAgIGNvbnN0IGFsbEJ1dHRvbnMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFxuICAgICAgICAnbm90aWZpY2F0aW9uLXN1YnNjcmlwdGlvbi1sYWJlbCcsXG4gICAgICApO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhbGxCdXR0b25zLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGFsbEJ1dHRvbnNbaV0uY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKTtcbiAgICAgIH1cbiAgICAgIGlmIChzaG91bGRVbnN1YnNjcmliZVRvTm90aWZpY2F0aW9ucykge1xuICAgICAgICBjb25zdCB1bnN1YnNjcmliZUJ1dHRvbiA9IGFsbEJ1dHRvbnMubmFtZWRJdGVtKCd1bnN1YnNjcmliZScpO1xuICAgICAgICB1bnN1YnNjcmliZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpO1xuICAgICAgICAoeyBwYXlsb2FkIH0gPSB1bnN1YnNjcmliZUJ1dHRvbi5kYXRhc2V0KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRhcmdldC5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpO1xuICAgICAgICAoeyBwYXlsb2FkIH0gPSB0YXJnZXQuZGF0YXNldCk7XG4gICAgICB9XG4gICAgICBmZXRjaChgL25vdGlmaWNhdGlvbl9zdWJzY3JpcHRpb25zLyR7bm90aWZpYWJsZVR5cGV9LyR7bm90aWZpYWJsZUlkfWAsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBBY2NlcHQ6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAnWC1DU1JGLVRva2VuJzogd2luZG93LmNzcmZUb2tlbixcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgICBjcmVkZW50aWFsczogJ3NhbWUtb3JpZ2luJyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGNvbmZpZzogcGF5bG9hZCxcbiAgICAgICAgICAvLyBub3RpZmlhYmxlIHBhcmFtcyBhcmUgcGFzc2VkIHZpYSBVUkxcbiAgICAgICAgfSksXG4gICAgICB9KTtcbiAgICB9O1xuICB9XG5cbiAgY29uc3Qgc3Vic2NyaXB0aW9uQnV0dG9ucyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXG4gICAgJ25vdGlmaWNhdGlvbi1zdWJzY3JpcHRpb24tbGFiZWwnLFxuICApO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgc3Vic2NyaXB0aW9uQnV0dG9ucy5sZW5ndGg7IGkgKz0gMSkge1xuICAgIHN1YnNjcmlwdGlvbkJ1dHRvbnNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdXBkYXRlU3RhdHVzKGUudGFyZ2V0KTtcbiAgICAgIGlmICh0eXBlb2Ygd2luZG93LnNlbmRIYXB0aWNNZXNzYWdlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICB3aW5kb3cuc2VuZEhhcHRpY01lc3NhZ2UoJ21lZGl1bScpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHN1YnNjcmlwdGlvbkJ1dHRvbnNbaV0uYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7XG4gICAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicpIHtcbiAgICAgICAgdXBkYXRlU3RhdHVzKGUudGFyZ2V0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuXG53aW5kb3cuSW5zdGFudENsaWNrLm9uKCdjaGFuZ2UnLCAoKSA9PiB7XG4gIGxvYWRGdW5jdGlvbmFsaXR5KCk7XG59KTtcblxubG9hZEZ1bmN0aW9uYWxpdHkoKTtcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./app/javascript/packs/notificationSubscriptionHandler.js\n");

/***/ })

},[["./app/javascript/packs/notificationSubscriptionHandler.js","runtime~notificationSubscriptionHandler"]]]);