(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["Chat~Onboarding~onboardingRedirectCheck"],{

/***/ "./app/javascript/utilities/connect/getUnopenedChannels.jsx":
/*!******************************************************************!*\
  !*** ./app/javascript/utilities/connect/getUnopenedChannels.jsx ***!
  \******************************************************************/
/*! exports provided: getUnopenedChannels */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getUnopenedChannels\", function() { return getUnopenedChannels; });\n/* harmony import */ var preact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! preact */ \"./node_modules/preact/dist/preact.module.js\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! prop-types */ \"./node_modules/prop-types/index.js\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _pusher__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./pusher */ \"./app/javascript/utilities/connect/pusher.js\");\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\n\n/* global userData */\n\nvar UnopenedChannelNotice = /*#__PURE__*/function (_Component) {\n  _inherits(UnopenedChannelNotice, _Component);\n\n  var _super = _createSuper(UnopenedChannelNotice);\n\n  function UnopenedChannelNotice(props) {\n    var _this;\n\n    _classCallCheck(this, UnopenedChannelNotice);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"propTypes\", {\n      pusherKey: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.Object\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"updateMessageNotification\", function (unopenedChannels) {\n      var number = document.getElementById('connect-number');\n\n      _this.setState({\n        unopenedChannels: unopenedChannels\n      });\n\n      if (unopenedChannels.length > 0) {\n        if (unopenedChannels[0].adjusted_slug === \"@\".concat(userData().username)) {\n          return;\n        }\n\n        number.classList.remove('hidden');\n        number.innerHTML = unopenedChannels.length;\n        document.getElementById('connect-link').href = \"/connect/\".concat(unopenedChannels[0].adjusted_slug);\n        InstantClick.preload(document.getElementById('connect-link').href, 'force');\n      } else {\n        number.classList.add('hidden');\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"removeMessage\", function () {});\n\n    _defineProperty(_assertThisInitialized(_this), \"updateMessage\", function () {});\n\n    _defineProperty(_assertThisInitialized(_this), \"mentionedMessage\", function (e) {\n      if (window.location.pathname.startsWith('/connect')) {\n        return;\n      }\n\n      _this.setState(function (prevState) {\n        return {\n          unopenedChannels: prevState.unopenedChannels.map(function (unopenedChannel) {\n            return unopenedChannel.adjusted_slug === e.chat_channel_adjusted_slug ? _objectSpread(_objectSpread({}, unopenedChannel), {}, {\n              request_type: 'mentioned'\n            }) : unopenedChannel;\n          }),\n          visible: true\n        };\n      });\n\n      _this.hideNotice();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"messageOpened\", function (e) {\n      var unopenedChannels = _this.state.unopenedChannels;\n      if (!window.location.pathname.startsWith('/connect') || !window.location.pathname.includes(e.adjusted_slug)) return;\n\n      _this.updateMessageNotification(unopenedChannels.filter(function (unopenedChannel) {\n        return unopenedChannel.adjusted_slug !== e.adjusted_slug;\n      }));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"receiveNewMessage\", function (e) {\n      if (e.user_id === window.currentUser.id || window.location.pathname.startsWith('/connect') && e.user_id === window.currentUser.id && e.channel_type !== 'direct' || window.location.pathname.includes(e.chat_channel_adjusted_slug)) {\n        return;\n      }\n\n      var unopenedChannels = _this.state.unopenedChannels;\n      var newObj = {\n        adjusted_slug: e.chat_channel_adjusted_slug\n      };\n      var ifMessageExist = unopenedChannels.some(function (channel) {\n        return channel.adjusted_slug === newObj.adjusted_slug;\n      });\n\n      if (!ifMessageExist && newObj.adjusted_slug !== \"@\".concat(window.currentUser.username)) {\n        unopenedChannels.push(newObj);\n      }\n\n      if (ifMessageExist) {\n        var index = unopenedChannels.findIndex(function (channel) {\n          return channel.adjusted_slug === newObj.adjusted_slug;\n        });\n        unopenedChannels[index].notified = false;\n      }\n\n      if (!window.location.pathname.startsWith('/connect')) {\n        _this.setState({\n          visible: unopenedChannels.length > 0 && e.user_id !== window.currentUser.id && e.channel_type === 'direct'\n        });\n      }\n\n      _this.updateMessageNotification(unopenedChannels);\n\n      _this.hideNotice();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleClick\", function () {\n      _this.hideNotice();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"hideNotice\", function () {\n      setTimeout(function () {\n        _this.setState(function (prevState) {\n          return {\n            unopenedChannels: prevState.unopenedChannels.map(function (unopenedChannel) {\n              return !unopenedChannel.notified ? _objectSpread(_objectSpread({}, unopenedChannel), {}, {\n                notified: true\n              }) : unopenedChannel;\n            }),\n            visible: false\n          };\n        });\n      }, 7500);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"fetchUnopenedChannel\", function (successCb) {\n      fetch('/chat_channels?state=unopened', {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        credentials: 'same-origin'\n      }).then(function (response) {\n        return response.json();\n      }).then(successCb);\n    });\n\n    _this.state = {\n      visible: false,\n      unopenedChannels: []\n    };\n    return _this;\n  }\n\n  _createClass(UnopenedChannelNotice, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var pusherKey = this.props.pusherKey;\n      var appDomain = document.body.dataset.appDomain;\n      Object(_pusher__WEBPACK_IMPORTED_MODULE_2__[\"setupPusher\"])(pusherKey, {\n        channelId: \"private-message-notifications--\".concat(appDomain, \"-\").concat(window.currentUser.id),\n        messageCreated: this.receiveNewMessage,\n        messageDeleted: this.removeMessage,\n        messageEdited: this.updateMessage,\n        mentioned: this.mentionedMessage,\n        messageOpened: this.messageOpened\n      });\n      this.fetchUnopenedChannel(this.updateMessageNotification);\n\n      document.getElementById('connect-link').onclick = function () {\n        // Hack, should probably be its own component in future\n        document.getElementById('connect-number').classList.add('hidden');\n\n        _this2.setState({\n          visible: false\n        });\n      };\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          visible = _this$state.visible,\n          unopenedChannels = _this$state.unopenedChannels;\n\n      if (visible && unopenedChannels.some(function (channel) {\n        return !channel.notified;\n      })) {\n        var message = unopenedChannels.map(function (channel) {\n          if (channel.notified) return null;\n          return Object(preact__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"div\", null, channel.request_type === 'mentioned' ? 'You got mentioned in' : 'New Message from', ' ', Object(preact__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"a\", {\n            href: \"/connect/\".concat(channel.adjusted_slug),\n            style: {\n              background: '#66e2d5',\n              color: 'black',\n              border: '1px solid black',\n              padding: '2px 7px',\n              display: 'inline-block',\n              margin: '3px 6px',\n              borderRadius: '3px'\n            }\n          }, channel.adjusted_slug));\n        });\n        return Object(preact__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"a\", {\n          href: \"/connect/\".concat(unopenedChannels[0].adjusted_slug),\n          onClick: this.handleClick,\n          style: {\n            position: 'fixed',\n            zIndex: '200',\n            top: '44px',\n            right: 0,\n            left: 0,\n            background: '#66e2d5',\n            borderBottom: '1px solid black',\n            color: 'black',\n            fontWeight: 'bold',\n            textAlign: 'center',\n            fontSize: '17px',\n            opacity: '0.94',\n            padding: '19px 5px 14px'\n          }\n        }, message);\n      }\n\n      return '';\n    }\n  }]);\n\n  return UnopenedChannelNotice;\n}(preact__WEBPACK_IMPORTED_MODULE_0__[\"Component\"]);\n\n_defineProperty(UnopenedChannelNotice, \"defaultProps\", {\n  pusherKey: undefined\n});\n\nfunction getUnopenedChannels() {\n  if (window.frameElement) {\n    return;\n  }\n\n  Object(preact__WEBPACK_IMPORTED_MODULE_0__[\"render\"])(Object(preact__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(UnopenedChannelNotice, {\n    pusherKey: document.body.dataset.pusherKey\n  }), document.getElementById('message-notice'));\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hcHAvamF2YXNjcmlwdC91dGlsaXRpZXMvY29ubmVjdC9nZXRVbm9wZW5lZENoYW5uZWxzLmpzeD80NTUxIl0sIm5hbWVzIjpbIlVub3BlbmVkQ2hhbm5lbE5vdGljZSIsInByb3BzIiwicHVzaGVyS2V5IiwiUHJvcFR5cGVzIiwiT2JqZWN0IiwidW5vcGVuZWRDaGFubmVscyIsIm51bWJlciIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzZXRTdGF0ZSIsImxlbmd0aCIsImFkanVzdGVkX3NsdWciLCJ1c2VyRGF0YSIsInVzZXJuYW1lIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiaW5uZXJIVE1MIiwiaHJlZiIsIkluc3RhbnRDbGljayIsInByZWxvYWQiLCJhZGQiLCJlIiwid2luZG93IiwibG9jYXRpb24iLCJwYXRobmFtZSIsInN0YXJ0c1dpdGgiLCJwcmV2U3RhdGUiLCJtYXAiLCJ1bm9wZW5lZENoYW5uZWwiLCJjaGF0X2NoYW5uZWxfYWRqdXN0ZWRfc2x1ZyIsInJlcXVlc3RfdHlwZSIsInZpc2libGUiLCJoaWRlTm90aWNlIiwic3RhdGUiLCJpbmNsdWRlcyIsInVwZGF0ZU1lc3NhZ2VOb3RpZmljYXRpb24iLCJmaWx0ZXIiLCJ1c2VyX2lkIiwiY3VycmVudFVzZXIiLCJpZCIsImNoYW5uZWxfdHlwZSIsIm5ld09iaiIsImlmTWVzc2FnZUV4aXN0Iiwic29tZSIsImNoYW5uZWwiLCJwdXNoIiwiaW5kZXgiLCJmaW5kSW5kZXgiLCJub3RpZmllZCIsInNldFRpbWVvdXQiLCJzdWNjZXNzQ2IiLCJmZXRjaCIsIkFjY2VwdCIsImNyZWRlbnRpYWxzIiwidGhlbiIsInJlc3BvbnNlIiwianNvbiIsImFwcERvbWFpbiIsImJvZHkiLCJkYXRhc2V0Iiwic2V0dXBQdXNoZXIiLCJjaGFubmVsSWQiLCJtZXNzYWdlQ3JlYXRlZCIsInJlY2VpdmVOZXdNZXNzYWdlIiwibWVzc2FnZURlbGV0ZWQiLCJyZW1vdmVNZXNzYWdlIiwibWVzc2FnZUVkaXRlZCIsInVwZGF0ZU1lc3NhZ2UiLCJtZW50aW9uZWQiLCJtZW50aW9uZWRNZXNzYWdlIiwibWVzc2FnZU9wZW5lZCIsImZldGNoVW5vcGVuZWRDaGFubmVsIiwib25jbGljayIsIm1lc3NhZ2UiLCJiYWNrZ3JvdW5kIiwiY29sb3IiLCJib3JkZXIiLCJwYWRkaW5nIiwiZGlzcGxheSIsIm1hcmdpbiIsImJvcmRlclJhZGl1cyIsImhhbmRsZUNsaWNrIiwicG9zaXRpb24iLCJ6SW5kZXgiLCJ0b3AiLCJyaWdodCIsImxlZnQiLCJib3JkZXJCb3R0b20iLCJmb250V2VpZ2h0IiwidGV4dEFsaWduIiwiZm9udFNpemUiLCJvcGFjaXR5IiwiQ29tcG9uZW50IiwidW5kZWZpbmVkIiwiZ2V0VW5vcGVuZWRDaGFubmVscyIsImZyYW1lRWxlbWVudCIsInJlbmRlciJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUVBOztJQUVNQSxxQjs7Ozs7QUFTSixpQ0FBWUMsS0FBWixFQUFtQjtBQUFBOztBQUFBOztBQUNqQiw4QkFBTUEsS0FBTjs7QUFEaUIsZ0VBUlA7QUFDVkMsZUFBUyxFQUFFQyxpREFBUyxDQUFDQztBQURYLEtBUU87O0FBQUEsZ0ZBNEJTLFVBQUNDLGdCQUFELEVBQXNCO0FBQ2hELFVBQU1DLE1BQU0sR0FBR0MsUUFBUSxDQUFDQyxjQUFULENBQXdCLGdCQUF4QixDQUFmOztBQUNBLFlBQUtDLFFBQUwsQ0FBYztBQUFFSix3QkFBZ0IsRUFBaEJBO0FBQUYsT0FBZDs7QUFDQSxVQUFJQSxnQkFBZ0IsQ0FBQ0ssTUFBakIsR0FBMEIsQ0FBOUIsRUFBaUM7QUFDL0IsWUFBSUwsZ0JBQWdCLENBQUMsQ0FBRCxDQUFoQixDQUFvQk0sYUFBcEIsZ0JBQTBDQyxRQUFRLEdBQUdDLFFBQXJELENBQUosRUFBcUU7QUFDbkU7QUFDRDs7QUFDRFAsY0FBTSxDQUFDUSxTQUFQLENBQWlCQyxNQUFqQixDQUF3QixRQUF4QjtB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LENBQW9CTSxhQUFsQyxDQUROO0FBRUUsaUJBQU8sRUFBRSxLQUFLc0UsV0FGaEI7QUFHRSxlQUFLLEVBQUU7QUFDTEMsb0JBQVEsRUFBRSxPQURMO0FBRUxDLGtCQUFNLEVBQUUsS0FGSDtBQUdMQyxlQUFHLEVBQUUsTUFIQTtBQUlMQyxpQkFBSyxFQUFFLENBSkY7QUFLTEMsZ0JBQUksRUFBRSxDQUxEO0FBTUxaLHNCQUFVLEVBQUUsU0FOUDtBQU9MYSx3QkFBWSxFQUFFLGlCQVBUO0FBUUxaLGlCQUFLLEVBQUUsT0FSRjtBQVNMYSxzQkFBVSxFQUFFLE1BVFA7QUFVTEMscUJBQVMsRUFBRSxRQVZOO0FBV0xDLG9CQUFRLEVBQUUsTUFYTDtBQVlMQyxtQkFBTyxFQUFFLE1BWko7QUFhTGQsbUJBQU8sRUFBRTtBQWJKO0FBSFQsV0FtQkdKLE9BbkJILENBREY7QUF1QkQ7O0FBRUQsYUFBTyxFQUFQO0FBQ0Q7Ozs7RUF4TmlDbUIsZ0Q7O2dCQUE5QjVGLHFCLGtCQUtrQjtBQUNwQkUsV0FBUyxFQUFFMkY7QUFEUyxDOztBQXNOakIsU0FBU0MsbUJBQVQsR0FBK0I7QUFDcEMsTUFBSXhFLE1BQU0sQ0FBQ3lFLFlBQVgsRUFBeUI7QUFDdkI7QUFDRDs7QUFDREMsdURBQU0sQ0FDSixpREFBQyxxQkFBRDtBQUF1QixhQUFTLEVBQUV6RixRQUFRLENBQUNtRCxJQUFULENBQWNDLE9BQWQsQ0FBc0J6RDtBQUF4RCxJQURJLEVBRUpLLFFBQVEsQ0FBQ0MsY0FBVCxDQUF3QixnQkFBeEIsQ0FGSSxDQUFOO0FBSUQiLCJmaWxlIjoiLi9hcHAvamF2YXNjcmlwdC91dGlsaXRpZXMvY29ubmVjdC9nZXRVbm9wZW5lZENoYW5uZWxzLmpzeC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGgsIHJlbmRlciwgQ29tcG9uZW50IH0gZnJvbSAncHJlYWN0JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgeyBzZXR1cFB1c2hlciB9IGZyb20gJy4vcHVzaGVyJztcblxuLyogZ2xvYmFsIHVzZXJEYXRhICovXG5cbmNsYXNzIFVub3BlbmVkQ2hhbm5lbE5vdGljZSBleHRlbmRzIENvbXBvbmVudCB7XG4gIHByb3BUeXBlcyA9IHtcbiAgICBwdXNoZXJLZXk6IFByb3BUeXBlcy5PYmplY3QsXG4gIH07XG5cbiAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICBwdXNoZXJLZXk6IHVuZGVmaW5lZCxcbiAgfTtcblxuICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgdmlzaWJsZTogZmFsc2UsXG4gICAgICB1bm9wZW5lZENoYW5uZWxzOiBbXSxcbiAgICB9O1xuICB9XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgY29uc3QgeyBwdXNoZXJLZXkgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgeyBhcHBEb21haW4gfSA9IGRvY3VtZW50LmJvZHkuZGF0YXNldDtcbiAgICBzZXR1cFB1c2hlcihwdXNoZXJLZXksIHtcbiAgICAgIGNoYW5uZWxJZDogYHByaXZhdGUtbWVzc2FnZS1ub3RpZmljYXRpb25zLS0ke2FwcERvbWFpbn0tJHt3aW5kb3cuY3VycmVudFVzZXIuaWR9YCxcbiAgICAgIG1lc3NhZ2VDcmVhdGVkOiB0aGlzLnJlY2VpdmVOZXdNZXNzYWdlLFxuICAgICAgbWVzc2FnZURlbGV0ZWQ6IHRoaXMucmVtb3ZlTWVzc2FnZSxcbiAgICAgIG1lc3NhZ2VFZGl0ZWQ6IHRoaXMudXBkYXRlTWVzc2FnZSxcbiAgICAgIG1lbnRpb25lZDogdGhpcy5tZW50aW9uZWRNZXNzYWdlLFxuICAgICAgbWVzc2FnZU9wZW5lZDogdGhpcy5tZXNzYWdlT3BlbmVkLFxuICAgIH0pO1xuICAgIHRoaXMuZmV0Y2hVbm9wZW5lZENoYW5uZWwodGhpcy51cGRhdGVNZXNzYWdlTm90aWZpY2F0aW9uKTtcblxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb25uZWN0LWxpbmsnKS5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgLy8gSGFjaywgc2hvdWxkIHByb2JhYmx5IGJlIGl0cyBvd24gY29tcG9uZW50IGluIGZ1dHVyZVxuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nvbm5lY3QtbnVtYmVyJykuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgICB0aGlzLnNldFN0YXRlKHsgdmlzaWJsZTogZmFsc2UgfSk7XG4gICAgfTtcbiAgfVxuXG4gIHVwZGF0ZU1lc3NhZ2VOb3RpZmljYXRpb24gPSAodW5vcGVuZWRDaGFubmVscykgPT4ge1xuICAgIGNvbnN0IG51bWJlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb25uZWN0LW51bWJlcicpO1xuICAgIHRoaXMuc2V0U3RhdGUoeyB1bm9wZW5lZENoYW5uZWxzIH0pO1xuICAgIGlmICh1bm9wZW5lZENoYW5uZWxzLmxlbmd0aCA+IDApIHtcbiAgICAgIGlmICh1bm9wZW5lZENoYW5uZWxzWzBdLmFkanVzdGVkX3NsdWcgPT09IGBAJHt1c2VyRGF0YSgpLnVzZXJuYW1lfWApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgbnVtYmVyLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgICAgbnVtYmVyLmlubmVySFRNTCA9IHVub3BlbmVkQ2hhbm5lbHMubGVuZ3RoO1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXG4gICAgICAgICdjb25uZWN0LWxpbmsnLFxuICAgICAgKS5ocmVmID0gYC9jb25uZWN0LyR7dW5vcGVuZWRDaGFubmVsc1swXS5hZGp1c3RlZF9zbHVnfWA7XG4gICAgICBJbnN0YW50Q2xpY2sucHJlbG9hZChcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nvbm5lY3QtbGluaycpLmhyZWYsXG4gICAgICAgICdmb3JjZScsXG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICBudW1iZXIuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgfVxuICB9O1xuXG4gIHJlbW92ZU1lc3NhZ2UgPSAoKSA9PiB7fTtcblxuICB1cGRhdGVNZXNzYWdlID0gKCkgPT4ge307XG5cbiAgbWVudGlvbmVkTWVzc2FnZSA9IChlKSA9PiB7XG4gICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5zdGFydHNXaXRoKCcvY29ubmVjdCcpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5zZXRTdGF0ZSgocHJldlN0YXRlKSA9PiAoe1xuICAgICAgdW5vcGVuZWRDaGFubmVsczogcHJldlN0YXRlLnVub3BlbmVkQ2hhbm5lbHMubWFwKCh1bm9wZW5lZENoYW5uZWwpID0+XG4gICAgICAgIHVub3BlbmVkQ2hhbm5lbC5hZGp1c3RlZF9zbHVnID09PSBlLmNoYXRfY2hhbm5lbF9hZGp1c3RlZF9zbHVnXG4gICAgICAgICAgPyB7IC4uLnVub3BlbmVkQ2hhbm5lbCwgcmVxdWVzdF90eXBlOiAnbWVudGlvbmVkJyB9XG4gICAgICAgICAgOiB1bm9wZW5lZENoYW5uZWwsXG4gICAgICApLFxuICAgICAgdmlzaWJsZTogdHJ1ZSxcbiAgICB9KSk7XG5cbiAgICB0aGlzLmhpZGVOb3RpY2UoKTtcbiAgfTtcblxuICBtZXNzYWdlT3BlbmVkID0gKGUpID0+IHtcbiAgICBjb25zdCB7IHVub3BlbmVkQ2hhbm5lbHMgfSA9IHRoaXMuc3RhdGU7XG4gICAgaWYgKFxuICAgICAgIXdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5zdGFydHNXaXRoKCcvY29ubmVjdCcpIHx8XG4gICAgICAhd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLmluY2x1ZGVzKGUuYWRqdXN0ZWRfc2x1ZylcbiAgICApXG4gICAgICByZXR1cm47XG4gICAgdGhpcy51cGRhdGVNZXNzYWdlTm90aWZpY2F0aW9uKFxuICAgICAgdW5vcGVuZWRDaGFubmVscy5maWx0ZXIoXG4gICAgICAgICh1bm9wZW5lZENoYW5uZWwpID0+IHVub3BlbmVkQ2hhbm5lbC5hZGp1c3RlZF9zbHVnICE9PSBlLmFkanVzdGVkX3NsdWcsXG4gICAgICApLFxuICAgICk7XG4gIH07XG5cbiAgcmVjZWl2ZU5ld01lc3NhZ2UgPSAoZSkgPT4ge1xuICAgIGlmIChcbiAgICAgIGUudXNlcl9pZCA9PT0gd2luZG93LmN1cnJlbnRVc2VyLmlkIHx8XG4gICAgICAod2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9jb25uZWN0JykgJiZcbiAgICAgICAgZS51c2VyX2lkID09PSB3aW5kb3cuY3VycmVudFVzZXIuaWQgJiZcbiAgICAgICAgZS5jaGFubmVsX3R5cGUgIT09ICdkaXJlY3QnKSB8fFxuICAgICAgd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLmluY2x1ZGVzKGUuY2hhdF9jaGFubmVsX2FkanVzdGVkX3NsdWcpXG4gICAgKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHsgdW5vcGVuZWRDaGFubmVscyB9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCBuZXdPYmogPSB7IGFkanVzdGVkX3NsdWc6IGUuY2hhdF9jaGFubmVsX2FkanVzdGVkX3NsdWcgfTtcblxuICAgIGNvbnN0IGlmTWVzc2FnZUV4aXN0ID0gdW5vcGVuZWRDaGFubmVscy5zb21lKFxuICAgICAgKGNoYW5uZWwpID0+IGNoYW5uZWwuYWRqdXN0ZWRfc2x1ZyA9PT0gbmV3T2JqLmFkanVzdGVkX3NsdWcsXG4gICAgKTtcblxuICAgIGlmIChcbiAgICAgICFpZk1lc3NhZ2VFeGlzdCAmJlxuICAgICAgbmV3T2JqLmFkanVzdGVkX3NsdWcgIT09IGBAJHt3aW5kb3cuY3VycmVudFVzZXIudXNlcm5hbWV9YFxuICAgICkge1xuICAgICAgdW5vcGVuZWRDaGFubmVscy5wdXNoKG5ld09iaik7XG4gICAgfVxuICAgIGlmIChpZk1lc3NhZ2VFeGlzdCkge1xuICAgICAgY29uc3QgaW5kZXggPSB1bm9wZW5lZENoYW5uZWxzLmZpbmRJbmRleChcbiAgICAgICAgKGNoYW5uZWwpID0+IGNoYW5uZWwuYWRqdXN0ZWRfc2x1ZyA9PT0gbmV3T2JqLmFkanVzdGVkX3NsdWcsXG4gICAgICApO1xuICAgICAgdW5vcGVuZWRDaGFubmVsc1tpbmRleF0ubm90aWZpZWQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAoIXdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5zdGFydHNXaXRoKCcvY29ubmVjdCcpKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgdmlzaWJsZTpcbiAgICAgICAgICB1bm9wZW5lZENoYW5uZWxzLmxlbmd0aCA+IDAgJiZcbiAgICAgICAgICBlLnVzZXJfaWQgIT09IHdpbmRvdy5jdXJyZW50VXNlci5pZCAmJlxuICAgICAgICAgIGUuY2hhbm5lbF90eXBlID09PSAnZGlyZWN0JyxcbiAgICAgIH0pO1xuICAgIH1cbiAgICB0aGlzLnVwZGF0ZU1lc3NhZ2VOb3RpZmljYXRpb24odW5vcGVuZWRDaGFubmVscyk7XG4gICAgdGhpcy5oaWRlTm90aWNlKCk7XG4gIH07XG5cbiAgaGFuZGxlQ2xpY2sgPSAoKSA9PiB7XG4gICAgdGhpcy5oaWRlTm90aWNlKCk7XG4gIH07XG5cbiAgaGlkZU5vdGljZSA9ICgpID0+IHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoKHByZXZTdGF0ZSkgPT4gKHtcbiAgICAgICAgdW5vcGVuZWRDaGFubmVsczogcHJldlN0YXRlLnVub3BlbmVkQ2hhbm5lbHMubWFwKCh1bm9wZW5lZENoYW5uZWwpID0+XG4gICAgICAgICAgIXVub3BlbmVkQ2hhbm5lbC5ub3RpZmllZFxuICAgICAgICAgICAgPyB7IC4uLnVub3BlbmVkQ2hhbm5lbCwgbm90aWZpZWQ6IHRydWUgfVxuICAgICAgICAgICAgOiB1bm9wZW5lZENoYW5uZWwsXG4gICAgICAgICksXG4gICAgICAgIHZpc2libGU6IGZhbHNlLFxuICAgICAgfSkpO1xuICAgIH0sIDc1MDApO1xuICB9O1xuXG4gIGZldGNoVW5vcGVuZWRDaGFubmVsID0gKHN1Y2Nlc3NDYikgPT4ge1xuICAgIGZldGNoKCcvY2hhdF9jaGFubmVscz9zdGF0ZT11bm9wZW5lZCcsIHtcbiAgICAgIEFjY2VwdDogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgIGNyZWRlbnRpYWxzOiAnc2FtZS1vcmlnaW4nLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzcG9uc2UpID0+IHJlc3BvbnNlLmpzb24oKSlcbiAgICAgIC50aGVuKHN1Y2Nlc3NDYik7XG4gIH07XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgdmlzaWJsZSwgdW5vcGVuZWRDaGFubmVscyB9ID0gdGhpcy5zdGF0ZTtcbiAgICBpZiAodmlzaWJsZSAmJiB1bm9wZW5lZENoYW5uZWxzLnNvbWUoKGNoYW5uZWwpID0+ICFjaGFubmVsLm5vdGlmaWVkKSkge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IHVub3BlbmVkQ2hhbm5lbHMubWFwKChjaGFubmVsKSA9PiB7XG4gICAgICAgIGlmIChjaGFubmVsLm5vdGlmaWVkKSByZXR1cm4gbnVsbDtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAge2NoYW5uZWwucmVxdWVzdF90eXBlID09PSAnbWVudGlvbmVkJ1xuICAgICAgICAgICAgICA/ICdZb3UgZ290IG1lbnRpb25lZCBpbidcbiAgICAgICAgICAgICAgOiAnTmV3IE1lc3NhZ2UgZnJvbSd9eycgJ31cbiAgICAgICAgICAgIDxhXG4gICAgICAgICAgICAgIGhyZWY9e2AvY29ubmVjdC8ke2NoYW5uZWwuYWRqdXN0ZWRfc2x1Z31gfVxuICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6ICcjNjZlMmQ1JyxcbiAgICAgICAgICAgICAgICBjb2xvcjogJ2JsYWNrJyxcbiAgICAgICAgICAgICAgICBib3JkZXI6ICcxcHggc29saWQgYmxhY2snLFxuICAgICAgICAgICAgICAgIHBhZGRpbmc6ICcycHggN3B4JyxcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiAnaW5saW5lLWJsb2NrJyxcbiAgICAgICAgICAgICAgICBtYXJnaW46ICczcHggNnB4JyxcbiAgICAgICAgICAgICAgICBib3JkZXJSYWRpdXM6ICczcHgnLFxuICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7Y2hhbm5lbC5hZGp1c3RlZF9zbHVnfVxuICAgICAgICAgICAgPC9hPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiAoXG4gICAgICAgIDxhXG4gICAgICAgICAgaHJlZj17YC9jb25uZWN0LyR7dW5vcGVuZWRDaGFubmVsc1swXS5hZGp1c3RlZF9zbHVnfWB9XG4gICAgICAgICAgb25DbGljaz17dGhpcy5oYW5kbGVDbGlja31cbiAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgcG9zaXRpb246ICdmaXhlZCcsXG4gICAgICAgICAgICB6SW5kZXg6ICcyMDAnLFxuICAgICAgICAgICAgdG9wOiAnNDRweCcsXG4gICAgICAgICAgICByaWdodDogMCxcbiAgICAgICAgICAgIGxlZnQ6IDAsXG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiAnIzY2ZTJkNScsXG4gICAgICAgICAgICBib3JkZXJCb3R0b206ICcxcHggc29saWQgYmxhY2snLFxuICAgICAgICAgICAgY29sb3I6ICdibGFjaycsXG4gICAgICAgICAgICBmb250V2VpZ2h0OiAnYm9sZCcsXG4gICAgICAgICAgICB0ZXh0QWxpZ246ICdjZW50ZXInLFxuICAgICAgICAgICAgZm9udFNpemU6ICcxN3B4JyxcbiAgICAgICAgICAgIG9wYWNpdHk6ICcwLjk0JyxcbiAgICAgICAgICAgIHBhZGRpbmc6ICcxOXB4IDVweCAxNHB4JyxcbiAgICAgICAgICB9fVxuICAgICAgICA+XG4gICAgICAgICAge21lc3NhZ2V9XG4gICAgICAgIDwvYT5cbiAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuICcnO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRVbm9wZW5lZENoYW5uZWxzKCkge1xuICBpZiAod2luZG93LmZyYW1lRWxlbWVudCkge1xuICAgIHJldHVybjtcbiAgfVxuICByZW5kZXIoXG4gICAgPFVub3BlbmVkQ2hhbm5lbE5vdGljZSBwdXNoZXJLZXk9e2RvY3VtZW50LmJvZHkuZGF0YXNldC5wdXNoZXJLZXl9IC8+LFxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtZXNzYWdlLW5vdGljZScpLFxuICApO1xufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./app/javascript/utilities/connect/getUnopenedChannels.jsx\n");

/***/ }),

/***/ "./app/javascript/utilities/connect/index.js":
/*!***************************************************!*\
  !*** ./app/javascript/utilities/connect/index.js ***!
  \***************************************************/
/*! exports provided: getUnopenedChannels, setupPusher */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _getUnopenedChannels__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./getUnopenedChannels */ \"./app/javascript/utilities/connect/getUnopenedChannels.jsx\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getUnopenedChannels\", function() { return _getUnopenedChannels__WEBPACK_IMPORTED_MODULE_0__[\"getUnopenedChannels\"]; });\n\n/* harmony import */ var _pusher__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./pusher */ \"./app/javascript/utilities/connect/pusher.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"setupPusher\", function() { return _pusher__WEBPACK_IMPORTED_MODULE_1__[\"setupPusher\"]; });\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hcHAvamF2YXNjcmlwdC91dGlsaXRpZXMvY29ubmVjdC9pbmRleC5qcz9hMDU4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEiLCJmaWxlIjoiLi9hcHAvamF2YXNjcmlwdC91dGlsaXRpZXMvY29ubmVjdC9pbmRleC5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCAqIGZyb20gJy4vZ2V0VW5vcGVuZWRDaGFubmVscyc7XG5leHBvcnQgKiBmcm9tICcuL3B1c2hlcic7XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./app/javascript/utilities/connect/index.js\n");

/***/ }),

/***/ "./app/javascript/utilities/connect/pusher.js":
/*!****************************************************!*\
  !*** ./app/javascript/utilities/connect/pusher.js ***!
  \****************************************************/
/*! exports provided: setupPusher */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setupPusher\", function() { return setupPusher; });\n// import Pusher from 'pusher-js';\nfunction setupPusher(key, callbackObjects) {\n  return __webpack_require__.e(/*! import() */ 15).then(__webpack_require__.t.bind(null, /*! pusher-js */ \"./node_modules/pusher-js/dist/web/pusher.js\", 7)).then(function (_) {\n    var _window = window,\n        _window$pusher = _window.pusher,\n        pusher = _window$pusher === void 0 ? new Pusher(key, {\n      authEndpoint: '/pusher/auth',\n      auth: {\n        headers: {\n          'X-CSRF-Token': window.csrfToken\n        }\n      },\n      cluster: 'us2',\n      encrypted: true\n    }) : _window$pusher;\n    window.pusher = pusher;\n    var channel = pusher.subscribe(callbackObjects.channelId.toString());\n    channel.bind('message-created', callbackObjects.messageCreated);\n    channel.bind('message-deleted', callbackObjects.messageDeleted);\n    channel.bind('message-edited', callbackObjects.messageEdited);\n    channel.bind('mentioned', callbackObjects.mentioned);\n    channel.bind('message-opened', callbackObjects.messageOpened);\n    channel.bind('channel-cleared', callbackObjects.channelCleared);\n    channel.bind('user-banned', callbackObjects.redactUserMessages);\n    channel.bind('pusher:subscription_error', callbackObjects.channelError);\n    return channel;\n  });\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hcHAvamF2YXNjcmlwdC91dGlsaXRpZXMvY29ubmVjdC9wdXNoZXIuanM/M2M2OSJdLCJuYW1lcyI6WyJzZXR1cFB1c2hlciIsImtleSIsImNhbGxiYWNrT2JqZWN0cyIsInRoZW4iLCJfIiwid2luZG93IiwicHVzaGVyIiwiUHVzaGVyIiwiYXV0aEVuZHBvaW50IiwiYXV0aCIsImhlYWRlcnMiLCJjc3JmVG9rZW4iLCJjbHVzdGVyIiwiZW5jcnlwdGVkIiwiY2hhbm5lbCIsInN1YnNjcmliZSIsImNoYW5uZWxJZCIsInRvU3RyaW5nIiwiYmluZCIsIm1lc3NhZ2VDcmVhdGVkIiwibWVzc2FnZURlbGV0ZWQiLCJtZXNzYWdlRWRpdGVkIiwibWVudGlvbmVkIiwibWVzc2FnZU9wZW5lZCIsImNoYW5uZWxDbGVhcmVkIiwicmVkYWN0VXNlck1lc3NhZ2VzIiwiY2hhbm5lbEVycm9yIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFFTyxTQUFTQSxXQUFULENBQXFCQyxHQUFyQixFQUEwQkMsZUFBMUIsRUFBMkM7QUFDaEQsU0FBTyxvSkFBb0JDLElBQXBCLENBQXlCLFVBQUNDLENBQUQsRUFBTztBQUFBLGtCQVlqQ0MsTUFaaUM7QUFBQSxpQ0FFbkNDLE1BRm1DO0FBQUEsUUFFbkNBLE1BRm1DLCtCQUUxQixJQUFJQyxNQUFKLENBQVdOLEdBQVgsRUFBZ0I7QUFDdkJPLGtCQUFZLEVBQUUsY0FEUztBQUV2QkMsVUFBSSxFQUFFO0FBQ0pDLGVBQU8sRUFBRTtBQUNQLDBCQUFnQkwsTUFBTSxDQUFDTTtBQURoQjtBQURMLE9BRmlCO0FBT3ZCQyxhQUFPLEVBQUUsS0FQYztBQVF2QkMsZUFBUyxFQUFFO0FBUlksS0FBaEIsQ0FGMEI7QUFjckNSLFVBQU0sQ0FBQ0MsTUFBUCxHQUFnQkEsTUFBaEI7QUFFQSxRQUFNUSxPQUFPLEdBQUdSLE1BQU0sQ0FBQ1MsU0FBUCxDQUFpQmIsZUFBZSxDQUFDYyxTQUFoQixDQUEwQkMsUUFBMUIsRUFBakIsQ0FBaEI7QUFDQUgsV0FBTyxDQUFDSSxJQUFSLENBQWEsaUJBQWIsRUFBZ0NoQixlQUFlLENBQUNpQixjQUFoRDtBQUNBTCxXQUFPLENBQUNJLElBQVIsQ0FBYSxpQkFBYixFQUFnQ2hCLGVBQWUsQ0FBQ2tCLGNBQWhEO0FBQ0FOLFdBQU8sQ0FBQ0ksSUFBUixDQUFhLGdCQUFiLEVBQStCaEIsZUFBZSxDQUFDbUIsYUFBL0M7QUFDQVAsV0FBTyxDQUFDSSxJQUFSLENBQWEsV0FBYixFQUEwQmhCLGVBQWUsQ0FBQ29CLFNBQTFDO0FBQ0FSLFdBQU8sQ0FBQ0ksSUFBUixDQUFhLGdCQUFiLEVBQStCaEIsZUFBZSxDQUFDcUIsYUFBL0M7QUFDQVQsV0FBTyxDQUFDSSxJQUFSLENBQWEsaUJBQWIsRUFBZ0NoQixlQUFlLENBQUNzQixjQUFoRDtBQUNBVixXQUFPLENBQUNJLElBQVIsQ0FBYSxhQUFiLEVBQTRCaEIsZUFBZSxDQUFDdUIsa0JBQTVDO0FBRUFYLFdBQU8sQ0FBQ0ksSUFBUixDQUFhLDJCQUFiLEVBQTBDaEIsZUFBZSxDQUFDd0IsWUFBMUQ7QUFFQSxXQUFPWixPQUFQO0FBQ0QsR0E1Qk0sQ0FBUDtBQTZCRCIsImZpbGUiOiIuL2FwcC9qYXZhc2NyaXB0L3V0aWxpdGllcy9jb25uZWN0L3B1c2hlci5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIGltcG9ydCBQdXNoZXIgZnJvbSAncHVzaGVyLWpzJztcblxuZXhwb3J0IGZ1bmN0aW9uIHNldHVwUHVzaGVyKGtleSwgY2FsbGJhY2tPYmplY3RzKSB7XG4gIHJldHVybiBpbXBvcnQoJ3B1c2hlci1qcycpLnRoZW4oKF8pID0+IHtcbiAgICBjb25zdCB7XG4gICAgICBwdXNoZXIgPSBuZXcgUHVzaGVyKGtleSwge1xuICAgICAgICBhdXRoRW5kcG9pbnQ6ICcvcHVzaGVyL2F1dGgnLFxuICAgICAgICBhdXRoOiB7XG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ1gtQ1NSRi1Ub2tlbic6IHdpbmRvdy5jc3JmVG9rZW4sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgY2x1c3RlcjogJ3VzMicsXG4gICAgICAgIGVuY3J5cHRlZDogdHJ1ZSxcbiAgICAgIH0pLFxuICAgIH0gPSB3aW5kb3c7XG5cbiAgICB3aW5kb3cucHVzaGVyID0gcHVzaGVyO1xuXG4gICAgY29uc3QgY2hhbm5lbCA9IHB1c2hlci5zdWJzY3JpYmUoY2FsbGJhY2tPYmplY3RzLmNoYW5uZWxJZC50b1N0cmluZygpKTtcbiAgICBjaGFubmVsLmJpbmQoJ21lc3NhZ2UtY3JlYXRlZCcsIGNhbGxiYWNrT2JqZWN0cy5tZXNzYWdlQ3JlYXRlZCk7XG4gICAgY2hhbm5lbC5iaW5kKCdtZXNzYWdlLWRlbGV0ZWQnLCBjYWxsYmFja09iamVjdHMubWVzc2FnZURlbGV0ZWQpO1xuICAgIGNoYW5uZWwuYmluZCgnbWVzc2FnZS1lZGl0ZWQnLCBjYWxsYmFja09iamVjdHMubWVzc2FnZUVkaXRlZCk7XG4gICAgY2hhbm5lbC5iaW5kKCdtZW50aW9uZWQnLCBjYWxsYmFja09iamVjdHMubWVudGlvbmVkKTtcbiAgICBjaGFubmVsLmJpbmQoJ21lc3NhZ2Utb3BlbmVkJywgY2FsbGJhY2tPYmplY3RzLm1lc3NhZ2VPcGVuZWQpO1xuICAgIGNoYW5uZWwuYmluZCgnY2hhbm5lbC1jbGVhcmVkJywgY2FsbGJhY2tPYmplY3RzLmNoYW5uZWxDbGVhcmVkKTtcbiAgICBjaGFubmVsLmJpbmQoJ3VzZXItYmFubmVkJywgY2FsbGJhY2tPYmplY3RzLnJlZGFjdFVzZXJNZXNzYWdlcyk7XG5cbiAgICBjaGFubmVsLmJpbmQoJ3B1c2hlcjpzdWJzY3JpcHRpb25fZXJyb3InLCBjYWxsYmFja09iamVjdHMuY2hhbm5lbEVycm9yKTtcblxuICAgIHJldHVybiBjaGFubmVsO1xuICB9KTtcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./app/javascript/utilities/connect/pusher.js\n");

/***/ })

}]);