!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):global.WebShareWrapper=factory()}(this,function(){"use strict";var createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),possibleConstructorReturn=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call};function _CustomElement(){return Reflect.construct(HTMLElement,[],this.__proto__.constructor)}Object.setPrototypeOf(_CustomElement.prototype,HTMLElement.prototype),Object.setPrototypeOf(_CustomElement,HTMLElement);var WebShareWrapper=function(_CustomElement2){function WebShareWrapper(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,WebShareWrapper);var _this=possibleConstructorReturn(this,(WebShareWrapper.__proto__||Object.getPrototypeOf(WebShareWrapper)).call(this));if(_this.webShare="share"in navigator,_this.webShare){var templateId=_this.getTemplateId();if(null!==templateId){var template=document.getElementById(templateId);if(!template)return possibleConstructorReturn(_this);_this.removeChildren();var clone=document.importNode(template.content,!0);_this.appendChild(clone)}else _this.text=document.createTextNode(_this.getAttribute("text")||"Share"),_this.button=document.createElement("button"),_this.button.appendChild(_this.text),_this.removeChildren(),_this.appendChild(_this.button);_this.share=_this.share.bind(_this)}return _this}return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(WebShareWrapper,_CustomElement),createClass(WebShareWrapper,[{key:"share",value:function(event){var _this2=this;event.preventDefault();var shareOptions={title:this.getTitle(),text:this.getText(),url:this.getUrl()};navigator.share(shareOptions).then(function(){return _this2.successfulShare(shareOptions)}).catch(function(error){return _this2.abortedShare(error,shareOptions)})}},{key:"connectedCallback",value:function(){this.webShare&&this.addEventListener("click",this.share)}},{key:"disconnectedCallback",value:function(){this.webShare&&this.removeEventListener("click",this.share)}},{key:"successfulShare",value:function(options){var event=new CustomEvent("share-success",options);this.dispatchEvent(event,{detail:options})}},{key:"abortedShare",value:function(error,options){options.error=error;var event=new CustomEvent("share-failure",{detail:options});this.dispatchEvent(event)}},{key:"getTitle",value:function(){return this.getAttribute("sharetitle")}},{key:"getText",value:function(){return this.getAttribute("sharetext")||document.querySelector("title").textContent}},{key:"getUrl",value:function(){if(this.getAttribute("shareurl"))return this.getAttribute("shareurl");var canonicalElement=document.querySelector("link[rel=canonical]");return null!==canonicalElement?canonicalElement.getAttribute("href"):window.location.href}},{key:"getTemplateId",value:function(){return this.getAttribute("template")}},{key:"removeChildren",value:function(){for(;this.firstChild;)this.removeChild(this.firstChild)}}]),WebShareWrapper}();return"customElements"in window&&customElements.define("web-share-wrapper",WebShareWrapper),WebShareWrapper});