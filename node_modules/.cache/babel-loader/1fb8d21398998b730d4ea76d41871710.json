{"ast":null,"code":"/* eslint-disable no-alert */\nexport default function initBlock() {\n  var blockButton = document.getElementById('user-profile-dropdownmenu-block-button');\n\n  if (!blockButton) {\n    // button not always present when this is called\n    return;\n  }\n\n  var profileUserId = blockButton.dataset.profileUserId;\n\n  function unblock() {\n    fetch(\"/user_blocks/\".concat(profileUserId), {\n      method: 'DELETE',\n      headers: {\n        Accept: 'application/json',\n        'X-CSRF-Token': window.csrfToken,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        user_block: {\n          blocked_id: profileUserId\n        }\n      })\n    }).then(function (response) {\n      return response.json();\n    }).then(function (response) {\n      if (response.result === 'unblocked') {\n        blockButton.innerText = 'Block';\n        /* eslint-disable-next-line no-use-before-define */\n\n        blockButton.addEventListener('click', block, {\n          once: true\n        });\n      } else if (response.status === 422) {\n        window.alert(\"Something went wrong: \".concat(response.error, \" -- Please refresh the page to try again.\"));\n      }\n    })[\"catch\"](function (e) {\n      window.alert(\"Something went wrong: \".concat(e, \". -- Please refresh the page to try again.\"));\n    });\n  }\n\n  function block() {\n    var confirmBlock = window.confirm(\"Are you sure you want to block this person? This will:\\n      - prevent them from commenting on your posts\\n      - block all notifications from them\\n      - prevent them from messaging you via DEV Connect\");\n\n    if (confirmBlock) {\n      fetch(\"/user_blocks\", {\n        method: 'POST',\n        headers: {\n          Accept: 'application/json',\n          'X-CSRF-Token': window.csrfToken,\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          user_block: {\n            blocked_id: profileUserId\n          }\n        })\n      }).then(function (response) {\n        return response.json();\n      }).then(function (response) {\n        if (response.result === 'blocked') {\n          blockButton.innerText = 'Unblock';\n          blockButton.addEventListener('click', unblock, {\n            once: true\n          });\n        } else if (response.status === 422) {\n          window.alert(\"Something went wrong: \".concat(response.error, \". -- Please refresh the page to try again.\"));\n        }\n      })[\"catch\"](function (e) {\n        window.alert(\"Something went wrong: \".concat(e, \". -- Please refresh the page to try again.\"));\n      });\n    } else {\n      blockButton.addEventListener('click', block, {\n        once: true\n      });\n    }\n  } // userData() is a global function\n\n  /* eslint-disable-next-line no-undef */\n\n\n  var user = userData();\n\n  if (!user) {\n    return;\n  }\n\n  if (user.id === parseInt(profileUserId, 10)) {\n    blockButton.style.display = 'none';\n  } else {\n    fetch(\"/user_blocks/\".concat(profileUserId)).then(function (response) {\n      return response.json();\n    }).then(function (response) {\n      if (response.result === 'blocking') {\n        blockButton.innerText = 'Unblock';\n        blockButton.addEventListener('click', unblock, {\n          once: true\n        });\n      } else {\n        blockButton.addEventListener('click', block, {\n          once: true\n        });\n      }\n    });\n  }\n}\n/* eslint-enable no-alert */","map":{"version":3,"sources":["/Users/nmadhab/hobby/forem/app/javascript/profileDropdown/blockButton.js"],"names":["initBlock","blockButton","document","getElementById","profileUserId","dataset","unblock","fetch","method","headers","Accept","window","csrfToken","body","JSON","stringify","user_block","blocked_id","then","response","json","result","innerText","addEventListener","block","once","status","alert","error","e","confirmBlock","confirm","user","userData","id","parseInt","style","display"],"mappings":"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","sourcesContent":["/* eslint-disable no-alert */\n\nexport default function initBlock() {\n  const blockButton = document.getElementById(\n    'user-profile-dropdownmenu-block-button',\n  );\n  if (!blockButton) {\n    // button not always present when this is called\n    return;\n  }\n  const { profileUserId } = blockButton.dataset;\n\n  function unblock() {\n    fetch(`/user_blocks/${profileUserId}`, {\n      method: 'DELETE',\n      headers: {\n        Accept: 'application/json',\n        'X-CSRF-Token': window.csrfToken,\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        user_block: {\n          blocked_id: profileUserId,\n        },\n      }),\n    })\n      .then((response) => response.json())\n      .then((response) => {\n        if (response.result === 'unblocked') {\n          blockButton.innerText = 'Block';\n          /* eslint-disable-next-line no-use-before-define */\n          blockButton.addEventListener('click', block, { once: true });\n        } else if (response.status === 422) {\n          window.alert(\n            `Something went wrong: ${response.error} -- Please refresh the page to try again.`,\n          );\n        }\n      })\n      .catch((e) => {\n        window.alert(\n          `Something went wrong: ${e}. -- Please refresh the page to try again.`,\n        );\n      });\n  }\n\n  function block() {\n    const confirmBlock = window.confirm(\n      `Are you sure you want to block this person? This will:\n      - prevent them from commenting on your posts\n      - block all notifications from them\n      - prevent them from messaging you via DEV Connect`,\n    );\n    if (confirmBlock) {\n      fetch(`/user_blocks`, {\n        method: 'POST',\n        headers: {\n          Accept: 'application/json',\n          'X-CSRF-Token': window.csrfToken,\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          user_block: {\n            blocked_id: profileUserId,\n          },\n        }),\n      })\n        .then((response) => response.json())\n        .then((response) => {\n          if (response.result === 'blocked') {\n            blockButton.innerText = 'Unblock';\n            blockButton.addEventListener('click', unblock, { once: true });\n          } else if (response.status === 422) {\n            window.alert(\n              `Something went wrong: ${response.error}. -- Please refresh the page to try again.`,\n            );\n          }\n        })\n        .catch((e) => {\n          window.alert(\n            `Something went wrong: ${e}. -- Please refresh the page to try again.`,\n          );\n        });\n    } else {\n      blockButton.addEventListener('click', block, { once: true });\n    }\n  }\n\n  // userData() is a global function\n  /* eslint-disable-next-line no-undef */\n  const user = userData();\n  if (!user) {\n    return;\n  }\n\n  if (user.id === parseInt(profileUserId, 10)) {\n    blockButton.style.display = 'none';\n  } else {\n    fetch(`/user_blocks/${profileUserId}`)\n      .then((response) => response.json())\n      .then((response) => {\n        if (response.result === 'blocking') {\n          blockButton.innerText = 'Unblock';\n          blockButton.addEventListener('click', unblock, { once: true });\n        } else {\n          blockButton.addEventListener('click', block, { once: true });\n        }\n      });\n  }\n}\n\n/* eslint-enable no-alert */\n"]},"metadata":{},"sourceType":"module"}