{"ast":null,"code":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _toArray(arr) { return _arrayWithHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter); }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport { h, render } from 'preact';\nimport PropTypes from 'prop-types';\nimport { Article, LoadingArticle } from '../articles';\nimport { Feed } from '../articles/Feed';\nimport { TodaysPodcasts, PodcastEpisode } from '../podcasts';\nimport { articlePropTypes } from '../common-prop-types';\n/**\n * Sends analytics about the featured article.\n *\n * @param {number} articleId\n */\n\nfunction sendFeaturedArticleAnalytics(articleId) {\n  (function logFeaturedArticleImpression() {\n    if (!window.ga || !ga.create) {\n      setTimeout(logFeaturedArticleImpression, 20);\n      return;\n    }\n\n    ga('send', 'event', 'view', 'featured-feed-impression', \"articles-\".concat(articleId), null);\n  })();\n}\n\nvar FeedLoading = function FeedLoading() {\n  return h(\"div\", null, h(LoadingArticle, {\n    version: \"featured\"\n  }), h(LoadingArticle, null), h(LoadingArticle, null), h(LoadingArticle, null), h(LoadingArticle, null), h(LoadingArticle, null), h(LoadingArticle, null));\n};\n\nvar PodcastEpisodes = function PodcastEpisodes(_ref) {\n  var episodes = _ref.episodes;\n  return h(TodaysPodcasts, null, episodes.map(function (episode) {\n    return h(PodcastEpisode, {\n      episode: episode\n    });\n  }));\n};\n\nPodcastEpisodes.defaultProps = {\n  episodes: []\n};\nPodcastEpisodes.propTypes = {\n  episodes: PropTypes.arrayOf(articlePropTypes)\n};\n/**\n * Renders the main feed.\n */\n\nexport var renderFeed = function renderFeed(timeFrame) {\n  var feedContainer = document.getElementById('homepage-feed');\n  render(h(Feed, {\n    timeFrame: timeFrame,\n    renderFeed: function renderFeed(_ref2) {\n      var feedItems = _ref2.feedItems,\n          podcastEpisodes = _ref2.podcastEpisodes,\n          bookmarkedFeedItems = _ref2.bookmarkedFeedItems,\n          bookmarkClick = _ref2.bookmarkClick;\n\n      if (feedItems.length === 0) {\n        // Fancy loading ✨\n        return h(FeedLoading, null);\n      }\n\n      var commonProps = {\n        bookmarkClick: bookmarkClick\n      };\n\n      var _feedItems = _toArray(feedItems),\n          featuredStory = _feedItems[0],\n          subStories = _feedItems.slice(1);\n\n      var feedStyle = JSON.parse(document.body.dataset.user).feed_style;\n\n      if (featuredStory) {\n        sendFeaturedArticleAnalytics(featuredStory.id);\n      } // 1. Show the featured story first\n      // 2. Podcast episodes out today\n      // 3. Rest of the stories for the feed\n\n\n      return h(\"div\", null, featuredStory && h(Article, _extends({}, commonProps, {\n        article: featuredStory,\n        isFeatured: true,\n        feedStyle: feedStyle,\n        isBookmarked: bookmarkedFeedItems.has(featuredStory.id)\n      })), podcastEpisodes.length > 0 && h(PodcastEpisodes, {\n        episodes: podcastEpisodes\n      }), (subStories || []).map(function (story) {\n        return h(Article, _extends({}, commonProps, {\n          article: story,\n          feedStyle: feedStyle,\n          isBookmarked: bookmarkedFeedItems.has(story.id)\n        }));\n      }));\n    }\n  }), feedContainer, feedContainer.firstElementChild);\n};","map":{"version":3,"sources":["/Users/nmadhab/hobby/forem/app/javascript/packs/homePageFeed.jsx"],"names":["h","render","PropTypes","Article","LoadingArticle","Feed","TodaysPodcasts","PodcastEpisode","articlePropTypes","sendFeaturedArticleAnalytics","articleId","logFeaturedArticleImpression","window","ga","create","setTimeout","FeedLoading","PodcastEpisodes","episodes","map","episode","defaultProps","propTypes","arrayOf","renderFeed","timeFrame","feedContainer","document","getElementById","feedItems","podcastEpisodes","bookmarkedFeedItems","bookmarkClick","length","commonProps","featuredStory","subStories","feedStyle","JSON","parse","body","dataset","user","feed_style","id","has","story","firstElementChild"],"mappings":"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","sourcesContent":["import { h, render } from 'preact';\nimport PropTypes from 'prop-types';\nimport { Article, LoadingArticle } from '../articles';\nimport { Feed } from '../articles/Feed';\nimport { TodaysPodcasts, PodcastEpisode } from '../podcasts';\nimport { articlePropTypes } from '../common-prop-types';\n\n/**\n * Sends analytics about the featured article.\n *\n * @param {number} articleId\n */\nfunction sendFeaturedArticleAnalytics(articleId) {\n  (function logFeaturedArticleImpression() {\n    if (!window.ga || !ga.create) {\n      setTimeout(logFeaturedArticleImpression, 20);\n      return;\n    }\n\n    ga(\n      'send',\n      'event',\n      'view',\n      'featured-feed-impression',\n      `articles-${articleId}`,\n      null,\n    );\n  })();\n}\n\nconst FeedLoading = () => (\n  <div>\n    <LoadingArticle version=\"featured\" />\n    <LoadingArticle />\n    <LoadingArticle />\n    <LoadingArticle />\n    <LoadingArticle />\n    <LoadingArticle />\n    <LoadingArticle />\n  </div>\n);\n\nconst PodcastEpisodes = ({ episodes }) => (\n  <TodaysPodcasts>\n    {episodes.map((episode) => (\n      <PodcastEpisode episode={episode} />\n    ))}\n  </TodaysPodcasts>\n);\n\nPodcastEpisodes.defaultProps = {\n  episodes: [],\n};\n\nPodcastEpisodes.propTypes = {\n  episodes: PropTypes.arrayOf(articlePropTypes),\n};\n\n/**\n * Renders the main feed.\n */\nexport const renderFeed = (timeFrame) => {\n  const feedContainer = document.getElementById('homepage-feed');\n\n  render(\n    <Feed\n      timeFrame={timeFrame}\n      renderFeed={({\n        feedItems,\n        podcastEpisodes,\n        bookmarkedFeedItems,\n        bookmarkClick,\n      }) => {\n        if (feedItems.length === 0) {\n          // Fancy loading ✨\n          return <FeedLoading />;\n        }\n\n        const commonProps = {\n          bookmarkClick,\n        };\n\n        const [featuredStory, ...subStories] = feedItems;\n        const feedStyle = JSON.parse(document.body.dataset.user).feed_style;\n        if (featuredStory) {\n          sendFeaturedArticleAnalytics(featuredStory.id);\n        }\n\n        // 1. Show the featured story first\n        // 2. Podcast episodes out today\n        // 3. Rest of the stories for the feed\n        return (\n          <div>\n            {featuredStory && (\n              <Article\n                {...commonProps}\n                article={featuredStory}\n                isFeatured\n                feedStyle={feedStyle}\n                isBookmarked={bookmarkedFeedItems.has(featuredStory.id)}\n              />\n            )}\n            {podcastEpisodes.length > 0 && (\n              <PodcastEpisodes episodes={podcastEpisodes} />\n            )}\n            {(subStories || []).map((story) => (\n              <Article\n                {...commonProps}\n                article={story}\n                feedStyle={feedStyle}\n                isBookmarked={bookmarkedFeedItems.has(story.id)}\n              />\n            ))}\n          </div>\n        );\n      }}\n    />,\n    feedContainer,\n    feedContainer.firstElementChild,\n  );\n};\n"]},"metadata":{},"sourceType":"module"}