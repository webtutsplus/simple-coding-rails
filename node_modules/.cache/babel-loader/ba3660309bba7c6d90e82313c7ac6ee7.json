{"ast":null,"code":"function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nimport { toggleFlagUserModal } from '../packs/flagUserModal';\nimport { request } from '@utilities/http';\nexport function addCloseListener() {\n  var button = document.getElementsByClassName('close-actions-panel')[0];\n  button.addEventListener('click', function () {\n    // getting the article show page document because this is called within an iframe\n    // eslint-disable-next-line no-restricted-globals\n    var articleDocument = top.document;\n    articleDocument.getElementsByClassName('mod-actions-menu')[0].classList.toggle('showing');\n    articleDocument.getElementsByClassName('mod-actions-menu-btn')[0].classList.toggle('hidden');\n  });\n}\nexport function initializeHeight() {\n  document.documentElement.style.height = '100%';\n  document.body.style.cssText = 'height: 100%; margin: 0; padding-top: 0; overflow-y: hidden';\n  document.getElementById('page-content').style.cssText = 'margin-top: 0 !important; margin-bottom: 0;';\n}\n\nfunction toggleDropdown(type) {\n  if (type === 'set-experience') {\n    document.getElementsByClassName('set-experience-options')[0].classList.toggle('hidden');\n  } else if (type === 'adjust-tags') {\n    document.getElementsByClassName('adjust-tags-options')[0].classList.toggle('hidden');\n  }\n}\n\nfunction applyReactedClass(category) {\n  var upVote = document.querySelector(\"[data-category='thumbsup']\");\n  var downVote = document.querySelector(\"[data-category='thumbsdown']\");\n  var vomitVote = document.querySelector(\"[data-category='vomit']\");\n\n  if (category === 'thumbsup') {\n    downVote.classList.remove('reacted');\n    vomitVote.classList.remove('reacted');\n  } else {\n    upVote.classList.remove('reacted');\n  }\n}\n\nexport function addReactionButtonListeners() {\n  var butts = Array.from(document.querySelectorAll('.reaction-button, .reaction-vomit-button'));\n  /* eslint-disable camelcase */\n\n  butts.forEach(function (butt) {\n    butt.addEventListener('click', /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (event) {\n        event.preventDefault();\n        var _butt$dataset = butt.dataset,\n            reactable_type = _butt$dataset.reactableType,\n            category = _butt$dataset.category,\n            reactable_id = _butt$dataset.reactableId;\n        applyReactedClass(category);\n        butt.classList.toggle('reacted');\n\n        try {\n          var response = yield request('/reactions', {\n            method: 'POST',\n            body: {\n              reactable_type: reactable_type,\n              category: category,\n              reactable_id: reactable_id\n            }\n          });\n          var outcome = yield response.json();\n          var message;\n          /* eslint-disable no-restricted-globals */\n\n          if (outcome.result === 'create' && outcome.category === 'thumbsup') {\n            message = 'This post will be more visible.';\n          } else if (outcome.result === 'create' && outcome.category === 'thumbsdown') {\n            message = 'This post will be less visible.';\n          } else if (outcome.result === 'create' && outcome.category === 'vomit') {\n            message = \"You've flagged this post as abusive or spam.\";\n          } else if (outcome.result === 'destroy') {\n            message = 'Your quality rating was removed.';\n          } else if (outcome.error) {\n            message = \"Error: \".concat(outcome.error);\n          }\n\n          top.addSnackbarItem({\n            message: message,\n            addCloseButton: true\n          });\n          /* eslint-enable no-restricted-globals */\n        } catch (error) {\n          // eslint-disable-next-line no-alert\n          alert(error);\n        }\n      });\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n  });\n  /* eslint-enable camelcase */\n}\n\nfunction clearExpLevels() {\n  Array.from(document.getElementsByClassName('level-rating-button selected')).forEach(function (el) {\n    el.classList.remove('selected');\n  });\n}\n\nexport function updateExperienceLevel(_x2, _x3, _x4, _x5) {\n  return _updateExperienceLevel.apply(this, arguments);\n}\n\nfunction _updateExperienceLevel() {\n  _updateExperienceLevel = _asyncToGenerator(function* (currentUserId, articleId, rating, group) {\n    try {\n      var response = yield request('/rating_votes', {\n        method: 'POST',\n        body: JSON.stringify({\n          rating_vote: {\n            user_id: currentUserId,\n            article_id: articleId,\n            rating: rating,\n            group: group\n          }\n        })\n      });\n      var outcome = yield response.json();\n\n      if (outcome.result === 'Success') {\n        clearExpLevels();\n        document.getElementById(\"js__rating__vote__\".concat(rating)).classList.add('selected');\n      } else {\n        // eslint-disable-next-line no-alert\n        alert(outcome.error);\n      }\n    } catch (error) {\n      // eslint-disable-next-line no-alert\n      alert(error);\n    }\n  });\n  return _updateExperienceLevel.apply(this, arguments);\n}\n\nvar adminUnpublishArticle = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator(function* (id, username, slug) {\n    try {\n      var response = yield request(\"/articles/\".concat(id, \"/admin_unpublish\"), {\n        method: 'PATCH',\n        body: JSON.stringify({\n          id: id,\n          username: username,\n          slug: slug\n        }),\n        credentials: 'same-origin'\n      });\n      var outcome = yield response.json();\n      /* eslint-disable no-restricted-globals */\n\n      if (outcome.message == 'success') {\n        window.top.location.assign(\"\".concat(window.location.origin).concat(outcome.path));\n      } else {\n        top.addSnackbarItem({\n          message: \"Error: \".concat(outcome.message),\n          addCloseButton: true\n        });\n      }\n    } catch (error) {\n      top.addSnackbarItem({\n        message: \"Error: \".concat(error),\n        addCloseButton: true\n      });\n    }\n  });\n\n  return function adminUnpublishArticle(_x6, _x7, _x8) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nfunction toggleSubmitContainer() {\n  document.getElementById('adjustment-reason-container').classList.toggle('hidden');\n}\n\nfunction clearAdjustmentReason() {\n  document.getElementById('tag-adjustment-reason').value = '';\n}\n\nfunction renderTagOnArticle(tagName, colors) {\n  /* eslint-disable no-restricted-globals */\n  var articleTagsContainer;\n\n  if (top.document.location.pathname.endsWith('/mod')) {\n    var _top$document$getElem = top.document.getElementById('quick-mod-article').contentDocument.getElementsByClassName('tags');\n\n    var _top$document$getElem2 = _slicedToArray(_top$document$getElem, 1);\n\n    articleTagsContainer = _top$document$getElem2[0];\n  } else {\n    var _top$document$getElem3 = top.document.getElementsByClassName('spec__tags');\n\n    var _top$document$getElem4 = _slicedToArray(_top$document$getElem3, 1);\n\n    articleTagsContainer = _top$document$getElem4[0];\n  }\n  /* eslint-enable no-restricted-globals */\n\n\n  var newTag = document.createElement('a');\n  newTag.innerText = \"#\".concat(tagName);\n  newTag.setAttribute('class', 'crayons-tag mr-1');\n  newTag.setAttribute('href', \"/t/\".concat(tagName));\n  newTag.style = \"background-color: \".concat(colors.bg, \"; color: \").concat(colors.text, \";\");\n  articleTagsContainer.appendChild(newTag);\n}\n\nfunction adjustTag(_x9) {\n  return _adjustTag.apply(this, arguments);\n}\n\nfunction _adjustTag() {\n  _adjustTag = _asyncToGenerator(function* (el) {\n    var reasonForAdjustment = document.getElementById('tag-adjustment-reason').value;\n    var body = {\n      tag_adjustment: {\n        // TODO: change to tag ID\n        tag_name: el.dataset.tagName || el.value,\n        article_id: el.dataset.articleId,\n        adjustment_type: el.dataset.adjustmentType === 'subtract' ? 'removal' : 'addition',\n        reason_for_adjustment: reasonForAdjustment\n      }\n    };\n\n    try {\n      var response = yield request('/tag_adjustments', {\n        method: 'POST',\n        body: JSON.stringify(body)\n      });\n      var outcome = yield response.json();\n\n      if (outcome.status === 'Success') {\n        var adjustedTagName;\n\n        if (el.tagName === 'BUTTON') {\n          adjustedTagName = el.dataset.tagName;\n          el.remove();\n        } else {\n          adjustedTagName = el.value; // eslint-disable-next-line no-param-reassign, require-atomic-updates\n\n          el.value = '';\n        }\n\n        toggleSubmitContainer();\n        clearAdjustmentReason();\n\n        if (outcome.result === 'addition') {\n          renderTagOnArticle(adjustedTagName, outcome.colors);\n        } else {\n          // eslint-disable-next-line no-restricted-globals\n          var tagOnArticle = top.document.querySelector(\".crayons-tag[href=\\\"/t/\".concat(adjustedTagName, \"\\\"]\"));\n          tagOnArticle.remove();\n        } // eslint-disable-next-line no-restricted-globals\n\n\n        top.addSnackbarItem({\n          message: \"The #\".concat(adjustedTagName, \" tag was \").concat(outcome.result === 'addition' ? 'added' : 'removed', \".\"),\n          addCloseButton: true\n        });\n      } else {\n        // eslint-disable-next-line no-restricted-globals\n        top.addSnackbarItem({\n          message: \"An error occurred: \".concat(outcome.error),\n          addCloseButton: true\n        });\n      }\n    } catch (error) {\n      // eslint-disable-next-line no-alert\n      alert(error);\n    }\n  });\n  return _adjustTag.apply(this, arguments);\n}\n\nexport function handleAdjustTagBtn(btn) {\n  var currentActiveTags = document.querySelectorAll('button.adjustable-tag.active');\n  var adminTagInput = document.getElementById('admin-add-tag');\n  /* eslint-disable no-restricted-globals */\n\n  /* eslint-disable no-alert */\n\n  if (adminTagInput && adminTagInput.value !== '' && confirm('This will clear your current \"Add a tag\" input. Do you want to continue?')) {\n    /* eslint-enable no-restricted-globals */\n\n    /* eslint-enable no-alert */\n    adminTagInput.value = '';\n  } else if (currentActiveTags.length > 0) {\n    currentActiveTags.forEach(function (tag) {\n      if (tag !== btn) {\n        tag.classList.remove('active');\n      }\n\n      btn.classList.toggle('active');\n    });\n\n    if (btn.classList.contains('active')) {\n      document.getElementById('adjustment-reason-container').classList.remove('hidden');\n    } else {\n      document.getElementById('adjustment-reason-container').classList.add('hidden');\n    }\n  } else {\n    btn.classList.toggle('active');\n    toggleSubmitContainer();\n  }\n}\n\nfunction handleAdminInput() {\n  var addTagInput = document.getElementById('admin-add-tag');\n\n  if (addTagInput) {\n    addTagInput.addEventListener('focus', function () {\n      document.getElementById('adjustment-reason-container').classList.remove('hidden');\n      var activeTagBtns = Array.from(document.querySelectorAll('button.adjustable-tag.active'));\n      activeTagBtns.forEach(function (btn) {\n        btn.classList.remove('active');\n      });\n    });\n    addTagInput.addEventListener('focusout', function () {\n      if (addTagInput.value === '') {\n        toggleSubmitContainer();\n      }\n    });\n  }\n}\n\nexport function addAdjustTagListeners() {\n  Array.from(document.getElementsByClassName('adjustable-tag')).forEach(function (btn) {\n    btn.addEventListener('click', function () {\n      handleAdjustTagBtn(btn);\n    });\n  });\n  var adjustTagSubmitBtn = document.getElementById('tag-adjust-submit');\n\n  if (adjustTagSubmitBtn) {\n    adjustTagSubmitBtn.addEventListener('click', function (e) {\n      e.preventDefault();\n      var textArea = document.getElementById('tag-adjustment-reason');\n      var dataSource = document.querySelector('button.adjustable-tag.active') || document.getElementById('admin-add-tag');\n\n      if (textArea.checkValidity()) {\n        adjustTag(dataSource);\n      }\n    });\n    handleAdminInput();\n  }\n}\nexport function addBottomActionsListeners() {\n  addAdjustTagListeners();\n  Array.from(document.getElementsByClassName('other-things-btn')).forEach(function (btn) {\n    btn.addEventListener('click', function () {\n      btn.classList.toggle('active');\n      var otherBtns = Array.from(document.getElementsByClassName('other-things-btn')).filter(function (otherBtn) {\n        return otherBtn !== btn;\n      });\n      otherBtns.forEach(function (otherBtn) {\n        otherBtn.classList.toggle('inactive');\n      });\n      btn.querySelector('.label-wrapper > .icon').classList.toggle('hidden');\n      btn.getElementsByClassName('toggle-chevron-container')[0].classList.toggle('rotated');\n      toggleDropdown(btn.dataset.otherThingsType);\n    });\n  });\n  Array.from(document.getElementsByClassName('level-rating-button')).forEach(function (btn) {\n    btn.addEventListener('click', function () {\n      updateExperienceLevel(btn.dataset.userId, btn.dataset.articleId, btn.value, btn.dataset.group);\n    });\n  });\n  var unpublishArticleBtn = document.getElementById('unpublish-article-btn');\n\n  if (unpublishArticleBtn) {\n    unpublishArticleBtn.addEventListener('click', function () {\n      var _unpublishArticleBtn$ = unpublishArticleBtn.dataset,\n          id = _unpublishArticleBtn$.articleId,\n          username = _unpublishArticleBtn$.articleAuthor,\n          slug = _unpublishArticleBtn$.articleSlug;\n\n      if (confirm('You are unpublishing this article; are you sure?')) {\n        adminUnpublishArticle(id, username, slug);\n      }\n    });\n  }\n\n  document.getElementById('open-flag-user-modal').addEventListener('click', toggleFlagUserModal);\n}\nexport function initializeActionsPanel() {\n  initializeHeight();\n  addCloseListener();\n  addReactionButtonListeners();\n  addBottomActionsListeners();\n}","map":{"version":3,"sources":["/Users/nmadhab/hobby/forem/app/javascript/actionsPanel/actionsPanel.js"],"names":["toggleFlagUserModal","request","addCloseListener","button","document","getElementsByClassName","addEventListener","articleDocument","top","classList","toggle","initializeHeight","documentElement","style","height","body","cssText","getElementById","toggleDropdown","type","applyReactedClass","category","upVote","querySelector","downVote","vomitVote","remove","addReactionButtonListeners","butts","Array","from","querySelectorAll","forEach","butt","event","preventDefault","dataset","reactable_type","reactableType","reactable_id","reactableId","response","method","outcome","json","message","result","error","addSnackbarItem","addCloseButton","alert","clearExpLevels","el","updateExperienceLevel","currentUserId","articleId","rating","group","JSON","stringify","rating_vote","user_id","article_id","add","adminUnpublishArticle","id","username","slug","credentials","window","location","assign","origin","path","toggleSubmitContainer","clearAdjustmentReason","value","renderTagOnArticle","tagName","colors","articleTagsContainer","pathname","endsWith","contentDocument","newTag","createElement","innerText","setAttribute","bg","text","appendChild","adjustTag","reasonForAdjustment","tag_adjustment","tag_name","adjustment_type","adjustmentType","reason_for_adjustment","status","adjustedTagName","tagOnArticle","handleAdjustTagBtn","btn","currentActiveTags","adminTagInput","confirm","length","tag","contains","handleAdminInput","addTagInput","activeTagBtns","addAdjustTagListeners","adjustTagSubmitBtn","e","textArea","dataSource","checkValidity","addBottomActionsListeners","otherBtns","filter","otherBtn","otherThingsType","userId","unpublishArticleBtn","articleAuthor","articleSlug","initializeActionsPanel"],"mappings":"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","sourcesContent":["import { toggleFlagUserModal } from '../packs/flagUserModal';\nimport { request } from '@utilities/http';\n\nexport function addCloseListener() {\n  const button = document.getElementsByClassName('close-actions-panel')[0];\n  button.addEventListener('click', () => {\n    // getting the article show page document because this is called within an iframe\n    // eslint-disable-next-line no-restricted-globals\n    const articleDocument = top.document;\n\n    articleDocument\n      .getElementsByClassName('mod-actions-menu')[0]\n      .classList.toggle('showing');\n    articleDocument\n      .getElementsByClassName('mod-actions-menu-btn')[0]\n      .classList.toggle('hidden');\n  });\n}\n\nexport function initializeHeight() {\n  document.documentElement.style.height = '100%';\n  document.body.style.cssText =\n    'height: 100%; margin: 0; padding-top: 0; overflow-y: hidden';\n  document.getElementById('page-content').style.cssText =\n    'margin-top: 0 !important; margin-bottom: 0;';\n}\n\nfunction toggleDropdown(type) {\n  if (type === 'set-experience') {\n    document\n      .getElementsByClassName('set-experience-options')[0]\n      .classList.toggle('hidden');\n  } else if (type === 'adjust-tags') {\n    document\n      .getElementsByClassName('adjust-tags-options')[0]\n      .classList.toggle('hidden');\n  }\n}\n\nfunction applyReactedClass(category) {\n  const upVote = document.querySelector(\"[data-category='thumbsup']\");\n  const downVote = document.querySelector(\"[data-category='thumbsdown']\");\n  const vomitVote = document.querySelector(\"[data-category='vomit']\");\n\n  if (category === 'thumbsup') {\n    downVote.classList.remove('reacted');\n    vomitVote.classList.remove('reacted');\n  } else {\n    upVote.classList.remove('reacted');\n  }\n}\n\nexport function addReactionButtonListeners() {\n  const butts = Array.from(\n    document.querySelectorAll('.reaction-button, .reaction-vomit-button'),\n  );\n  /* eslint-disable camelcase */\n  butts.forEach((butt) => {\n    butt.addEventListener('click', async (event) => {\n      event.preventDefault();\n      const {\n        reactableType: reactable_type,\n        category,\n        reactableId: reactable_id,\n      } = butt.dataset;\n\n      applyReactedClass(category);\n      butt.classList.toggle('reacted');\n\n      try {\n        const response = await request('/reactions', {\n          method: 'POST',\n          body: { reactable_type, category, reactable_id },\n        });\n\n        const outcome = await response.json();\n\n        let message;\n        /* eslint-disable no-restricted-globals */\n        if (outcome.result === 'create' && outcome.category === 'thumbsup') {\n          message = 'This post will be more visible.';\n        } else if (\n          outcome.result === 'create' &&\n          outcome.category === 'thumbsdown'\n        ) {\n          message = 'This post will be less visible.';\n        } else if (\n          outcome.result === 'create' &&\n          outcome.category === 'vomit'\n        ) {\n          message = \"You've flagged this post as abusive or spam.\";\n        } else if (outcome.result === 'destroy') {\n          message = 'Your quality rating was removed.';\n        } else if (outcome.error) {\n          message = `Error: ${outcome.error}`;\n        }\n        top.addSnackbarItem({\n          message,\n          addCloseButton: true,\n        });\n        /* eslint-enable no-restricted-globals */\n      } catch (error) {\n        // eslint-disable-next-line no-alert\n        alert(error);\n      }\n    });\n  });\n  /* eslint-enable camelcase */\n}\n\nfunction clearExpLevels() {\n  Array.from(\n    document.getElementsByClassName('level-rating-button selected'),\n  ).forEach((el) => {\n    el.classList.remove('selected');\n  });\n}\n\nexport async function updateExperienceLevel(\n  currentUserId,\n  articleId,\n  rating,\n  group,\n) {\n  try {\n    const response = await request('/rating_votes', {\n      method: 'POST',\n      body: JSON.stringify({\n        rating_vote: {\n          user_id: currentUserId,\n          article_id: articleId,\n          rating,\n          group,\n        },\n      }),\n    });\n\n    const outcome = await response.json();\n\n    if (outcome.result === 'Success') {\n      clearExpLevels();\n      document\n        .getElementById(`js__rating__vote__${rating}`)\n        .classList.add('selected');\n    } else {\n      // eslint-disable-next-line no-alert\n      alert(outcome.error);\n    }\n  } catch (error) {\n    // eslint-disable-next-line no-alert\n    alert(error);\n  }\n}\n\nconst adminUnpublishArticle = async (id, username, slug) => {\n  try {\n    const response = await request(`/articles/${id}/admin_unpublish`, {\n      method: 'PATCH',\n      body: JSON.stringify({ id, username, slug }),\n      credentials: 'same-origin',\n    });\n\n    const outcome = await response.json();\n\n    /* eslint-disable no-restricted-globals */\n    if (outcome.message == 'success') {\n      window.top.location.assign(`${window.location.origin}${outcome.path}`);\n    } else {\n      top.addSnackbarItem({\n        message: `Error: ${outcome.message}`,\n        addCloseButton: true,\n      });\n    }\n  } catch (error) {\n    top.addSnackbarItem({\n      message: `Error: ${error}`,\n      addCloseButton: true,\n    });\n  }\n};\n\nfunction toggleSubmitContainer() {\n  document\n    .getElementById('adjustment-reason-container')\n    .classList.toggle('hidden');\n}\n\nfunction clearAdjustmentReason() {\n  document.getElementById('tag-adjustment-reason').value = '';\n}\n\nfunction renderTagOnArticle(tagName, colors) {\n  /* eslint-disable no-restricted-globals */\n  let articleTagsContainer;\n  if (top.document.location.pathname.endsWith('/mod')) {\n    [articleTagsContainer] = top.document\n      .getElementById('quick-mod-article')\n      .contentDocument.getElementsByClassName('tags');\n  } else {\n    [articleTagsContainer] = top.document.getElementsByClassName('spec__tags');\n  }\n  /* eslint-enable no-restricted-globals */\n\n  const newTag = document.createElement('a');\n  newTag.innerText = `#${tagName}`;\n  newTag.setAttribute('class', 'crayons-tag mr-1');\n  newTag.setAttribute('href', `/t/${tagName}`);\n  newTag.style = `background-color: ${colors.bg}; color: ${colors.text};`;\n\n  articleTagsContainer.appendChild(newTag);\n}\n\nasync function adjustTag(el) {\n  const reasonForAdjustment = document.getElementById('tag-adjustment-reason')\n    .value;\n  const body = {\n    tag_adjustment: {\n      // TODO: change to tag ID\n      tag_name: el.dataset.tagName || el.value,\n      article_id: el.dataset.articleId,\n      adjustment_type:\n        el.dataset.adjustmentType === 'subtract' ? 'removal' : 'addition',\n      reason_for_adjustment: reasonForAdjustment,\n    },\n  };\n\n  try {\n    const response = await request('/tag_adjustments', {\n      method: 'POST',\n      body: JSON.stringify(body),\n    });\n\n    const outcome = await response.json();\n\n    if (outcome.status === 'Success') {\n      let adjustedTagName;\n      if (el.tagName === 'BUTTON') {\n        adjustedTagName = el.dataset.tagName;\n        el.remove();\n      } else {\n        adjustedTagName = el.value;\n        // eslint-disable-next-line no-param-reassign, require-atomic-updates\n        el.value = '';\n      }\n\n      toggleSubmitContainer();\n      clearAdjustmentReason();\n\n      if (outcome.result === 'addition') {\n        renderTagOnArticle(adjustedTagName, outcome.colors);\n      } else {\n        // eslint-disable-next-line no-restricted-globals\n        const tagOnArticle = top.document.querySelector(\n          `.crayons-tag[href=\"/t/${adjustedTagName}\"]`,\n        );\n        tagOnArticle.remove();\n      }\n\n      // eslint-disable-next-line no-restricted-globals\n      top.addSnackbarItem({\n        message: `The #${adjustedTagName} tag was ${\n          outcome.result === 'addition' ? 'added' : 'removed'\n        }.`,\n        addCloseButton: true,\n      });\n    } else {\n      // eslint-disable-next-line no-restricted-globals\n      top.addSnackbarItem({\n        message: `An error occurred: ${outcome.error}`,\n        addCloseButton: true,\n      });\n    }\n  } catch (error) {\n    // eslint-disable-next-line no-alert\n    alert(error);\n  }\n}\n\nexport function handleAdjustTagBtn(btn) {\n  const currentActiveTags = document.querySelectorAll(\n    'button.adjustable-tag.active',\n  );\n  const adminTagInput = document.getElementById('admin-add-tag');\n  /* eslint-disable no-restricted-globals */\n  /* eslint-disable no-alert */\n  if (\n    adminTagInput &&\n    adminTagInput.value !== '' &&\n    confirm(\n      'This will clear your current \"Add a tag\" input. Do you want to continue?',\n    )\n  ) {\n    /* eslint-enable no-restricted-globals */\n    /* eslint-enable no-alert */\n    adminTagInput.value = '';\n  } else if (currentActiveTags.length > 0) {\n    currentActiveTags.forEach((tag) => {\n      if (tag !== btn) {\n        tag.classList.remove('active');\n      }\n      btn.classList.toggle('active');\n    });\n    if (btn.classList.contains('active')) {\n      document\n        .getElementById('adjustment-reason-container')\n        .classList.remove('hidden');\n    } else {\n      document\n        .getElementById('adjustment-reason-container')\n        .classList.add('hidden');\n    }\n  } else {\n    btn.classList.toggle('active');\n    toggleSubmitContainer();\n  }\n}\n\nfunction handleAdminInput() {\n  const addTagInput = document.getElementById('admin-add-tag');\n\n  if (addTagInput) {\n    addTagInput.addEventListener('focus', () => {\n      document\n        .getElementById('adjustment-reason-container')\n        .classList.remove('hidden');\n\n      const activeTagBtns = Array.from(\n        document.querySelectorAll('button.adjustable-tag.active'),\n      );\n      activeTagBtns.forEach((btn) => {\n        btn.classList.remove('active');\n      });\n    });\n    addTagInput.addEventListener('focusout', () => {\n      if (addTagInput.value === '') {\n        toggleSubmitContainer();\n      }\n    });\n  }\n}\n\nexport function addAdjustTagListeners() {\n  Array.from(document.getElementsByClassName('adjustable-tag')).forEach(\n    (btn) => {\n      btn.addEventListener('click', () => {\n        handleAdjustTagBtn(btn);\n      });\n    },\n  );\n\n  const adjustTagSubmitBtn = document.getElementById('tag-adjust-submit');\n  if (adjustTagSubmitBtn) {\n    adjustTagSubmitBtn.addEventListener('click', (e) => {\n      e.preventDefault();\n      const textArea = document.getElementById('tag-adjustment-reason');\n      const dataSource =\n        document.querySelector('button.adjustable-tag.active') ||\n        document.getElementById('admin-add-tag');\n\n      if (textArea.checkValidity()) {\n        adjustTag(dataSource);\n      }\n    });\n\n    handleAdminInput();\n  }\n}\n\nexport function addBottomActionsListeners() {\n  addAdjustTagListeners();\n  Array.from(document.getElementsByClassName('other-things-btn')).forEach(\n    (btn) => {\n      btn.addEventListener('click', () => {\n        btn.classList.toggle('active');\n        const otherBtns = Array.from(\n          document.getElementsByClassName('other-things-btn'),\n        ).filter((otherBtn) => otherBtn !== btn);\n        otherBtns.forEach((otherBtn) => {\n          otherBtn.classList.toggle('inactive');\n        });\n\n        btn.querySelector('.label-wrapper > .icon').classList.toggle('hidden');\n        btn\n          .getElementsByClassName('toggle-chevron-container')[0]\n          .classList.toggle('rotated');\n        toggleDropdown(btn.dataset.otherThingsType);\n      });\n    },\n  );\n\n  Array.from(document.getElementsByClassName('level-rating-button')).forEach(\n    (btn) => {\n      btn.addEventListener('click', () => {\n        updateExperienceLevel(\n          btn.dataset.userId,\n          btn.dataset.articleId,\n          btn.value,\n          btn.dataset.group,\n        );\n      });\n    },\n  );\n\n  const unpublishArticleBtn = document.getElementById('unpublish-article-btn');\n  if (unpublishArticleBtn) {\n    unpublishArticleBtn.addEventListener('click', () => {\n      const {\n        articleId: id,\n        articleAuthor: username,\n        articleSlug: slug,\n      } = unpublishArticleBtn.dataset;\n\n      if (confirm('You are unpublishing this article; are you sure?')) {\n        adminUnpublishArticle(id, username, slug);\n      }\n    });\n  }\n\n  document\n    .getElementById('open-flag-user-modal')\n    .addEventListener('click', toggleFlagUserModal);\n}\n\nexport function initializeActionsPanel() {\n  initializeHeight();\n  addCloseListener();\n  addReactionButtonListeners();\n  addBottomActionsListeners();\n}\n"]},"metadata":{},"sourceType":"module"}