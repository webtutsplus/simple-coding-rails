---
gem: railties
framework: rails
cve: 2019-5420
date: 2019-03-13
url: https://groups.google.com/forum/#!topic/rubyonrails-security/IsQKvDqZdKw

title: Possible Remote Code Execution Exploit in Rails Development Mode

description: |
  There is a possible a possible remote code executing exploit in Rails when in
  development mode. This vulnerability has been assigned the CVE identifier
  CVE-2019-5420.

  Versions Affected:  6.0.0.X, 5.2.X.
  Not affected:       < 5.2.0
  Fixed Versions:     6.0.0.beta3, 5.2.2.1

  Impact
  ------
  With some knowledge of a target application it is possible for an attacker to
  guess the automatically generated development mode secret token.  This secret
  token can be used in combination with other Rails internals to escalate to a
  remote code execution exploit.

  All users running an affected release should either upgrade or use one of the
  workarounds immediately.

  Releases
  --------
  The 6.0.0.beta3 and 5.2.2.1 releases are available at the normal locations.

  Workarounds
  -----------
  This issue can be mitigated by specifying a secret key in development mode.
  In "config/environments/development.rb" add this:

    config.secret_key_base = SecureRandom.hex(64)

  Credits
  -------
  Thanks to ooooooo_q

unaffected_versions:
  - "< 5.2.0"

patched_versions:
  - "~> 5.2.2, >= 5.2.2.1"
  - ">= 6.0.0.beta3"
